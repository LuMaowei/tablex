{"version":3,"sources":["E:/WebRoot/tablex/src/featured/pagination/index.js","E:/WebRoot/tablex/src/featured/ColumnDropMenu.js","E:/WebRoot/tablex/src/featured/utils.js","E:/WebRoot/tablex/src/featured/setting/utils.js","E:/WebRoot/tablex/src/featured/setting/modal.js","E:/WebRoot/tablex/src/featured/setting/index.js","E:/WebRoot/tablex/src/featured/Table.js","E:/WebRoot/tablex/src/featured/Editable.js","E:/WebRoot/tablex/src/featured/index.js","E:/WebRoot/tablex/src/utils.js","E:/WebRoot/tablex/src/index.js"],"names":["Pager","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","onShowSizeChange","pageIndex","pageSize","onPageChange","onRefresh","_this$state","state","current","onPageIndexChange","onChange","total","_this$state2","pagerAttr","objectSpread","showSizeChanger","refreshButton","react_default","a","createElement","button_default","style","verticalAlign","icon","onClick","start","end","totalCount","totalInfo","className","pagination_default","nextProps","prevState","nextState","keys","length","React","Component","defaultProps","pageSizeOptions","SubMenu","Menu","HeadDropMenu","columnKey","config","onFilterColumnChange","checked","key","hidden","columnsFilter","_this$props","arr","columns","columnsConfig","columnsOptions","defaultChecked","forEach","c","i","isHide","dataIndex","push","display","checkbox_default","value","e","target","title","marginLeft","handleClick","_ref","item","domEvent","keyPath","1","fixed","2","3","6","grouped","7","stopPropagation","_ref2","styles","height","lineHeight","padding","_this$props$options","options","pinable","filterable","groupable","menu_default","forceSubMenuRender","width","mode","onTitleClick","Item","getParentElement","element","selector","isMatched","el","str","arguments","undefined","matched","firstChar","toLowerCase","split","selectorClass","elCls","indexOf","selectorID","elID","id","tagName","getParent","p","parentElement","treeToList","idField","treeList","leafs","roots","list","maxDepth","d","childrens","children","__depth","getChildren","depth","parents","tempArr","__parent","__parents","concat","sortedArr","sort","b","treeToFlatten","listToTree","pidField","tree","filter","y","_loop","nextId","len","assign","getTreeLeafs","getDataListWithExpanded","expandedKeys","rowKey","setChildren","cArr","treeFilter","fn","node","nextChildrens","getScrollbarWidth","navigator","userAgent","scrollbarWidth","oP","document","overflowY","body","appendChild","offsetWidth","clientWidth","remove","addCheckedKey","selectedRowKeys","flatData","halfCheckedKeys","nextKeys","nextHalfCheckedKeys","row","find","parentKeys","halfIndex","splice","parentHalfCheckedKeys","childrenSelectedKeys","bl","ck","_loop2","pNode","childrensAllChecked","cKey","k","findIndex","j","newHalflCheckedKeys","removeCheckedKey","childrenKeys","_loop3","m","_loop4","childrensAllUnChecked","addCheckedKeyWithDisabled","_ref3","_ref3$disabledSelectK","disabledSelectKeys","isEnabled","itemKey","parentEnableSelect","pArr","isEnableSelect","_loop5","getTime","cd","Date","getFullYear","getMonth","getDate","h","getHours","mi","getMinutes","s","getSeconds","serverSaveFunctionName","LocalConfig","get","allConfigs","JSON","parse","window","localStorage","getItem","settings","set","configs","defineProperty","time","setItem","stringify","getConfigs","setConfigs","saveConfigs","settedConfigs","serverSaveFn","Promise","resolve","reject","then","removeConfigs","treeForEach","RadioGroup","Radio","Group","RadioButton","Button","SortableItem","onChangeWidth","data","onChangeFixed","_this$props2","onToggleVisible","_this$props3","itemStyles","borderBottom","marginBottom","paddingBottom","fontWeight","textAlign","input_number_default","size","position","bottom","switch_default","checkedChildren","unCheckedChildren","SortableList","_this2","items","onDragEnd","bind","assertThisInitialized","result","destination","startIndex","endIndex","Array","from","_result$splice","removed","slicedToArray","reorder","source","index","onSort","_this3","react_beautiful_dnd_esm","droppableId","provided","snapshot","ref","innerRef","isDraggingOver","map","draggableId","draggableProps","dragHandleProps","isDragging","draggableStyle","userSelect","background","modal_SortableItem","placeholder","SettingModal","_this4","saveSettings","_this4$props","tableId","onSave","groupedColumnKey","setState","loading","visible","reset","_this4$props2","onReset","resetLoading","toggle","v","onOk","onCancel","cloneDeep","columnsOriginal","rawConfigs","setConfig","column","prevConfig","nextConfig","order","propsOriginal","columnsLeafs","settable","attrs","bodyStyle","minHeight","maxHeight","overflow","maskClosable","footer","type","modal_default","modal_SortableList","columnsArr","orderBy","Setting","modalRef","useRef","Fragment","createPortal","setting_modal","FeaturedTable","dropdown_button_ref","createRef","pagination","columnSettingMenuShow","container","sl","scrollLeft","left","top","offsetLeft","offsetTop","offsetHeight","click","columnMenu","dataset","columnkey","trigger","offsetX","offsetY","columnSettingMenuHide","onColumnResize","onColumnChange","newConfigs","formatColumns","headRender","data-columnkey","saveConfig","resetConfig","renderHeader","header","headerExtra","renderFooter","_this$state3","pageAttr","footerExtra","dataTotal","hasPager","hasPagination","pager","settingButton","marginRight","setting","rawColumns","featured_pagination","overlayRenderer","spin_default","spinning","tip","margin","right","zIndex","emptyRenderer","rowClassName","rowData","rowIndex","prevProps","_this$state$paginatio","Math","floor","getMaxCurrent","_","_this$state4","getCurrentPageData","newProps","onColumnResizeStop","striped","columnMenuState","lib_default","popover_default","onVisibleChange","content","ColumnDropMenu","arrowPointAtCenter","placement","dataSource","newPagination","orderNumber","EditableTable","rowsAttributes","tableRef","initRef","inst","isEditing","updateComponent","dataList","addedData","delayTimer","delayUpdate","delay","validateDelay","clearTimeout","setTimeout","isMouseFocus","changedRows","addToChanged","newRow","validateTrigger","validateRow","editChange","newValues","setRowAttr","attr","fRow","__attribute","merge","newAttr","getRowAttr","getValidate","validatorAsync","columnList","validation","validator","constructor","name","valid","msg","message","validateAsync","rows","r","all","datas","validate","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","next","sent","abrupt","stop","validateAll","_callee2","editKeys","isEditAll","allData","_context2","editorInstance","setEditorIns","ins","ed","getEditorIns","cols","editingVisible","editor","renderFn","render","renderProps","newRenderProps","colSpan","values","onKeyDown","tooltip_default","_ref4","editAll","endEdit","callBack","editSaveLoading","isAdding","isAddingRange","sourceData","editType","cancelEdit","editRows","getChangedRows","getRows","addRow","editting","addRows","_this$state5","rowKeys","newEditKeys","newAddedData","rowTemplate","setRows","focusInput","input","select","focus","ReactDom","findDOMNode","inputEl","getElementsByTagName","getNextEditor","keyCode","nextEditor","_this$state6","currIndex","nextRow","currColumnIndex","nextColumn","currEditor","getRealOpenState","completeEdit","_ref5","_callee3","_this$state7","allowSaveEmpty","alwaysValidate","newRows","addedRows","onEditSave","_context3","__isAddedRow","error","_x","apply","edit","onBeforeEdit","onEdit","selectedKeys","onBeforeDelete","warn","_this$state8","newData","deletedRows","deleteLoading","onDelete","addRange","rowCount","defaultAddCount","isAppend","onBeforeAdd","addCount","onAdd","editTools","tools","editToolsConfig","buttons","itemStyle","okText","okIcon","icon_default","cancelText","cancelIcon","addText","addIcon","editText","editIcon","deleteText","deleteIcon","menu","dropdown_default","overlay","tool","popconfirm_default","onConfirm","toolIcon","toolAttr","handler","text","getProps","createToolBar","editable","backgroundColor","getDataRows","_this$state9","updateRows","callback","api","delete","getData","_this$props$editTools","_this$props$editTools2","toolBar","onSelectChange","dataControled","Table","forwardRef","Editable","propTypes","PropTypes","bool","array","object","number","func","oneOf","flatten","unflatten","__webpack_require__","__webpack_exports__","utils_flatten","featured"],"mappings":"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","file":"static/js/examples-draggable~examples-expanded-row-render~examples-index~examples-large-data-edit~examples-playground.1ef0dd4d.js","sourcesContent":["import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport Pagination from \"antd/lib/pagination\";\r\nimport Button from \"antd/lib/button\";\r\nimport \"antd/dist/antd.css\";\r\nimport \"./styles.css\";\r\n\r\nclass Pager extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      current: props.current || 1,\r\n      pageSize: props.pageSize,\r\n      total: props.total\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, prevState) {\r\n    let nextState = {};\r\n\r\n    if (\"current\" in nextProps) {\r\n      nextState.current = nextProps.current;\r\n    }\r\n\r\n    if (\"pageSize\" in nextProps) {\r\n      nextState.pageSize = nextProps.pageSize;\r\n    }\r\n\r\n    if (\"total\" in nextProps) {\r\n      nextState.total = nextProps.total;\r\n    }\r\n\r\n    if (Object.keys(nextState).length > 0) {\r\n      return nextState;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  onShowSizeChange = (pageIndex, pageSize) => {\r\n    if (typeof this.props.onShowSizeChange === \"function\") {\r\n      this.props.onShowSizeChange(pageIndex, pageSize);\r\n    } else {\r\n      if (typeof this.props.onPageChange === \"function\") {\r\n        this.props.onPageChange(pageIndex, pageSize);\r\n      }\r\n    }\r\n  };\r\n\r\n  onRefresh = () => {\r\n    let { current, pageSize } = this.state;\r\n\r\n    if (typeof this.props.onRefresh === \"function\") {\r\n      this.props.onRefresh(current, pageSize);\r\n    } else {\r\n      if (typeof this.props.onPageChange === \"function\") {\r\n        this.props.onPageChange(current, pageSize);\r\n      }\r\n    }\r\n  };\r\n\r\n  onPageIndexChange = (pageIndex, pageSize) => {\r\n    if (typeof this.props.onChange === \"function\") {\r\n      this.props.onChange(pageIndex, pageSize);\r\n    } else {\r\n      if (typeof this.props.onPageChange === \"function\") {\r\n        this.props.onPageChange(pageIndex, pageSize);\r\n      }\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let { pageSize, current, total } = this.state;\r\n\r\n    let pagerAttr = {\r\n      ...this.props,\r\n      showSizeChanger: true,\r\n      onShowSizeChange: this.onShowSizeChange,\r\n      onChange: this.onPageIndexChange,\r\n      pageSize,\r\n      current,\r\n      total\r\n    };\r\n\r\n    let refreshButton = (\r\n      <Button\r\n        style={{ verticalAlign: \"middle\" }}\r\n        icon=\"reload\"\r\n        onClick={this.onRefresh}\r\n      />\r\n    );\r\n\r\n    let start = pageSize * (current - 1) + 1;\r\n    let end = pageSize * current;\r\n    end = end > total ? total : end;\r\n\r\n    let totalCount = total;\r\n\r\n    if (total <= 0) {\r\n      start = 0;\r\n      end = 0;\r\n      totalCount = 0;\r\n    }\r\n\r\n    let totalInfo = (\r\n      <div className=\"tablex__pager__count\">\r\n        显示 {start}-{end}，共 {totalCount} 条\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <div className=\"tablex__pager\">\r\n        <div className=\"tablex__pager__number\">\r\n          <Pagination {...pagerAttr} />\r\n          {refreshButton}\r\n        </div>\r\n        {totalInfo}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nPager.defaultProps = {\r\n  current: 1,\r\n  pageSize: 10,\r\n  total: 0,\r\n  pageSizeOptions: [\"10\", \"20\", \"30\", \"40\"],\r\n  onPageChange: () => {}\r\n};\r\n\r\nPager.propTypes = {\r\n  /** 当前页数 */\r\n  current: PropTypes.number.isRequired,\r\n  /** 每页条数 */\r\n  pageSize: PropTypes.number.isRequired,\r\n  /** 数据总数 */\r\n  total: PropTypes.number,\r\n  /** 页码，页大小改变事件 */\r\n  onPageChange: PropTypes.func,\r\n  /** 指定每页可以显示多少条 */\r\n  pageSizeOptions: PropTypes.array\r\n};\r\n\r\nexport default Pager;\r\n","import React from \"react\";\r\nimport Menu from \"antd/lib/menu\";\r\nimport Checkbox from \"antd/lib/checkbox\";\r\n\r\nconst SubMenu = Menu.SubMenu;\r\n\r\nclass HeadDropMenu extends React.Component {\r\n  onChange = (columnKey, config) => {\r\n    if (typeof this.props.onChange === \"function\") {\r\n      this.props.onChange(columnKey, config);\r\n    } else {\r\n    }\r\n  };\r\n\r\n  onFilterColumnChange = (checked, key) => {\r\n    this.onChange(key, {\r\n      hidden: !checked\r\n    });\r\n  };\r\n\r\n  columnsFilter = () => {\r\n    let { columns: arr, columnsConfig } = this.props;\r\n    \r\n    let columns = arr; //.filter(d => !!d.title)\r\n\r\n    const columnsOptions = [];\r\n    let defaultChecked = [];\r\n\r\n    columns.forEach((c, i) => {\r\n      let columnKey = c.key || c.dataIndex;\r\n\r\n      let isHide = false;\r\n\r\n      let config = (columnsConfig || {})[columnKey] || {};\r\n\r\n\r\n      isHide = !!config.hidden;\r\n\r\n      if (isHide === false) {\r\n        defaultChecked.push(columnKey);\r\n      }\r\n\r\n      columnsOptions.push(\r\n        <div key={i} style={{ display: \"block\" }}>\r\n          <Checkbox\r\n            checked={!isHide}\r\n            value={columnKey}\r\n            onChange={e => {\r\n              this.onFilterColumnChange(e.target.checked, columnKey);\r\n            }}\r\n          >\r\n            {c.title}\r\n          </Checkbox>\r\n        </div>\r\n      );\r\n    });\r\n\r\n    const columnsFilterItems = (\r\n      <div style={{ marginLeft: 10 }}>{columnsOptions}</div>\r\n    );\r\n\r\n    return columnsFilterItems;\r\n  };\r\n\r\n  handleClick = ({ item, key, keyPath, domEvent }) => {\r\n    let { columnKey } = this.props;\r\n\r\n    let config = {\r\n      1: {\r\n        fixed: \"left\"\r\n      },\r\n      2: {\r\n        fixed: \"right\"\r\n      },\r\n      3: {\r\n        fixed: false\r\n      },\r\n      6: {\r\n        grouped: true\r\n      },\r\n      7: {\r\n        grouped: false\r\n      }\r\n    }[key];\r\n\r\n    config && this.onChange(columnKey, config);\r\n\r\n    domEvent.stopPropagation();\r\n  };\r\n\r\n  onTitleClick({ key, domEvent }) {\r\n    domEvent.stopPropagation();\r\n  }\r\n\r\n  render() {\r\n    let styles = { height: \"auto\", lineHeight: \"normal\", padding: \"0px 10px\" };\r\n\r\n    let { pinable, filterable, groupable } = this.props.options;\r\n\r\n    return (\r\n      <div className=\"tablex__column__dropMenu\">\r\n        <Menu\r\n          forceSubMenuRender={false}\r\n          onClick={this.handleClick}\r\n          style={{ width: 160 }}\r\n          mode=\"vertical\"\r\n        >\r\n          {pinable && (\r\n            <SubMenu key=\"sub1\" title=\"列冻结\" onTitleClick={this.onTitleClick}>\r\n              <Menu.Item key=\"1\" style={styles}>\r\n                左侧\r\n              </Menu.Item>\r\n              <Menu.Item key=\"2\" style={styles}>\r\n                右侧\r\n              </Menu.Item>\r\n              <Menu.Item key=\"3\" style={styles}>\r\n                取消冻结\r\n              </Menu.Item>\r\n            </SubMenu>\r\n          )}\r\n          {filterable && (\r\n            <SubMenu\r\n              key=\"sub2\"\r\n              title=\"显示/隐藏\"\r\n              onTitleClick={this.onTitleClick}\r\n            >\r\n              <Menu.Item key=\"4\" style={styles}>\r\n                {this.columnsFilter()}\r\n              </Menu.Item>\r\n            </SubMenu>\r\n          )}\r\n          {groupable && (\r\n            <SubMenu key=\"sub3\" title=\"列分组\" onTitleClick={this.onTitleClick}>\r\n              <Menu.Item key=\"6\" style={styles}>\r\n                按此列分组\r\n              </Menu.Item>\r\n              <Menu.Item key=\"7\" style={styles}>\r\n                取消分组\r\n              </Menu.Item>\r\n            </SubMenu>\r\n          )}\r\n        </Menu>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HeadDropMenu;\r\n","export function getParentElement(element, selector) {\r\n  function isMatched(el, str = \"\") {\r\n    str = str.toLowerCase();\r\n\r\n    let matched = false;\r\n\r\n    let firstChar = str.split(\"\")[0];\r\n\r\n    if (firstChar === \".\") {\r\n      let selectorClass = str.split(\".\")[1] || \"\";\r\n      let elCls = el.className || \"\";\r\n      if (typeof elCls === \"string\") {\r\n        let cls = elCls.toLowerCase().split(\" \");\r\n        matched = cls.indexOf(selectorClass) > -1;\r\n      } else {\r\n        // 某些元素的className并不是string类型，比如：svg\r\n        // console.log(\"className:\", el.classList);\r\n      }\r\n    } else if (firstChar === \"#\") {\r\n      let selectorID = str.split(\"#\")[1] || \"\";\r\n      let elID = el.id || \"\";\r\n      if (typeof elID === \"string\") {\r\n        matched = elID.toLowerCase() === selectorID;\r\n      }\r\n    } else {\r\n      matched = el.tagName.toLowerCase() === str;\r\n    }\r\n\r\n    return matched;\r\n  }\r\n\r\n  function getParent(el, tagName) {\r\n    if (!el) {\r\n      return null;\r\n    }\r\n\r\n    if (isMatched(el, tagName)) {\r\n      return el;\r\n    }\r\n\r\n    let p = el.parentElement;\r\n\r\n    if (p !== null) {\r\n      if (isMatched(p, tagName)) {\r\n        return p;\r\n      } else {\r\n        return getParent(el.parentElement, tagName);\r\n      }\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  return getParent(element, selector);\r\n}\r\n\r\nexport function treeToList(arr, idField = \"id\") {\r\n  let treeList = arr || [];\r\n\r\n  //末级节点\r\n  let leafs = [];\r\n\r\n  //根\r\n  let roots = [];\r\n\r\n  //所有节点\r\n  let list = [];\r\n\r\n  let maxDepth = 0;\r\n\r\n  for (let i = 0; i < treeList.length; i++) {\r\n    const d = treeList[i];\r\n\r\n    if (!d) {\r\n      continue;\r\n    }\r\n\r\n    const childrens = d.children || [];\r\n\r\n    d.__depth = 0;\r\n\r\n    list.push(d);\r\n    roots.push(d);\r\n\r\n    if (childrens.length > 0) {\r\n      getChildren(d, 0, []);\r\n    } else {\r\n      leafs.push(d);\r\n    }\r\n  }\r\n\r\n  function getChildren(item, depth, parents) {\r\n    const tempArr = item.children || [];\r\n\r\n    for (let i = 0; i < tempArr.length; i++) {\r\n      const d = tempArr[i];\r\n      const childrens = d.children || [];\r\n\r\n      d.__depth = depth + 1;\r\n      d.__parent = {\r\n        title: item.title,\r\n        key: item[idField],\r\n        width: item.width\r\n      };\r\n\r\n      d.__parents = [].concat(parents).concat([item[idField]]);\r\n\r\n      list.push(d);\r\n\r\n      if (childrens.length > 0) {\r\n        getChildren(d, d.__depth, [].concat(d.__parents));\r\n      } else {\r\n        leafs.push(d);\r\n      }\r\n    }\r\n  }\r\n\r\n  if (leafs.length > 0) {\r\n    let sortedArr = [].concat(leafs);\r\n    sortedArr.sort((a, b) => b.__depth - a.__depth);\r\n    maxDepth = sortedArr[0].__depth;\r\n  }\r\n\r\n  return { list, leafs, roots, maxDepth };\r\n}\r\n\r\nexport function treeToFlatten(arr) {\r\n  let treeList = arr || [];\r\n\r\n  //末级节点\r\n  let leafs = [];\r\n  //根\r\n  let roots = [];\r\n\r\n  //所有节点\r\n  let list = [];\r\n\r\n  for (let i = 0; i < treeList.length; i++) {\r\n    const d = treeList[i];\r\n\r\n    if (!d) {\r\n      continue;\r\n    }\r\n    const childrens = d.children || [];\r\n\r\n    list.push(d);\r\n    roots.push(d);\r\n\r\n    if (childrens.length > 0) {\r\n      getChildren(d, 0);\r\n    } else {\r\n      leafs.push(d);\r\n    }\r\n  }\r\n\r\n  function getChildren(item, depth) {\r\n    const tempArr = item.children || [];\r\n\r\n    for (let i = 0; i < tempArr.length; i++) {\r\n      const d = tempArr[i];\r\n      const childrens = d.children || [];\r\n\r\n      list.push(d);\r\n\r\n      if (childrens.length > 0) {\r\n        getChildren(d, depth + 1);\r\n      } else {\r\n        leafs.push(d);\r\n      }\r\n    }\r\n  }\r\n\r\n  return { list, leafs, roots };\r\n}\r\n\r\nexport function listToTree(arr = [], idField, pidField) {\r\n  let tree = [];\r\n\r\n  function getChildren(item) {\r\n    let id = item[idField];\r\n\r\n    let childrens = arr.filter(y => y[pidField] === id);\r\n\r\n    for (let i = 0; i < childrens.length; i++) {\r\n      let d = childrens[i];\r\n      const nextId = d[idField];\r\n\r\n      const nextChildrens = arr.filter(y => y[pidField] === nextId);\r\n\r\n      if (nextChildrens.length > 0) {\r\n        d.children = getChildren(d);\r\n      }\r\n    }\r\n\r\n    return childrens;\r\n  }\r\n\r\n  let roots = arr.filter(d => !d[pidField]);\r\n\r\n  for (let i = 0, len = roots.length; i < len; i++) {\r\n    let d = Object.assign({}, roots[i]);\r\n\r\n    d.children = getChildren(d);\r\n\r\n    tree.push(d);\r\n  }\r\n\r\n  return tree;\r\n}\r\n\r\nexport function getTreeLeafs(arr) {\r\n  let treeList = arr || [];\r\n  //末级节点\r\n  let leafs = [];\r\n\r\n  for (let i = 0; i < treeList.length; i++) {\r\n    const d = treeList[i];\r\n\r\n    if (!d) {\r\n      continue;\r\n    }\r\n\r\n    const childrens = d.children || [];\r\n\r\n    if (childrens.length > 0) {\r\n      getChildren(d, 0);\r\n    } else {\r\n      leafs.push(d);\r\n    }\r\n  }\r\n\r\n  function getChildren(item, depth) {\r\n    const tempArr = item.children || [];\r\n\r\n    for (let i = 0; i < tempArr.length; i++) {\r\n      const d = tempArr[i];\r\n      const childrens = d.children || [];\r\n\r\n      if (childrens.length > 0) {\r\n        getChildren(d, depth + 1);\r\n      } else {\r\n        leafs.push(d);\r\n      }\r\n    }\r\n  }\r\n\r\n  return leafs;\r\n}\r\n\r\nexport function getDataListWithExpanded(list, expandedKeys = [], rowKey) {\r\n  let arr = [];\r\n\r\n  for (let i = 0; i < list.length; i++) {\r\n    let d = list[i];\r\n\r\n    d.__depth = 0;\r\n\r\n    arr.push(d);\r\n\r\n    if (expandedKeys.indexOf(d[rowKey]) > -1) {\r\n      if (d.children) {\r\n        setChildren(d, 0);\r\n      }\r\n    }\r\n  }\r\n\r\n  function setChildren(c, depth) {\r\n    let cArr = c.children;\r\n    for (let i = 0; i < cArr.length; i++) {\r\n      let d = cArr[i];\r\n      d.__depth = depth + 1;\r\n      arr.push(d);\r\n\r\n      if (expandedKeys.indexOf(d[rowKey]) > -1) {\r\n        if (d.children) {\r\n          setChildren(d, depth + 1);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return arr;\r\n}\r\n\r\nexport function treeFilter(arr, fn) {\r\n  let treeList = arr || [];\r\n\r\n  //根\r\n  let roots = [];\r\n\r\n  for (let i = 0; i < treeList.length; i++) {\r\n    const d = treeList[i];\r\n\r\n    let bl = fn(d, i);\r\n\r\n    if (bl === true) {\r\n      if (d.children && d.children.length > 0) {\r\n        d.children = getChildren(d);\r\n      }\r\n\r\n      roots.push(d);\r\n    }\r\n  }\r\n\r\n  function getChildren(node) {\r\n    const tempArr = node.children || [];\r\n\r\n    const nextChildrens = [];\r\n\r\n    for (let i = 0; i < tempArr.length; i++) {\r\n      const d = tempArr[i];\r\n\r\n      let bl = fn(d, i);\r\n\r\n      if (bl === true) {\r\n        if (d.children && d.children.length > 0) {\r\n          d.children = getChildren(d);\r\n        }\r\n\r\n        nextChildrens.push(d);\r\n      }\r\n    }\r\n\r\n    return nextChildrens;\r\n  }\r\n\r\n  return roots;\r\n}\r\n\r\nexport function getScrollbarWidth() {\r\n  var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串\r\n\r\n  if (userAgent.indexOf(\"Chrome\") > -1) {\r\n    return 6;\r\n  }\r\n\r\n  var oP = document.createElement(\"p\"),\r\n    styles = {\r\n      width: \"100px\",\r\n      height: \"100px\",\r\n      overflowY: \"scroll\"\r\n    },\r\n    i,\r\n    scrollbarWidth;\r\n\r\n  for (i in styles) {\r\n    oP.style[i] = styles[i];\r\n  }\r\n  document.body.appendChild(oP);\r\n  scrollbarWidth = oP.offsetWidth - oP.clientWidth;\r\n  oP.remove();\r\n\r\n  return scrollbarWidth;\r\n}\r\n\r\n/**\r\n * 添加选中行\r\n * @key {Array} 行key\r\n * @selectedRowKeys {Array} 当前选中的行key\r\n * @rowKey {string} 数据行主键key字段名\r\n * @flatData {Array} 展平的表格数据\r\n * @halfCheckedKeys {Array} 当前半选状态的行key\r\n */\r\nexport function addCheckedKey({\r\n  key,\r\n  selectedRowKeys,\r\n  rowKey,\r\n  flatData,\r\n  halfCheckedKeys\r\n}) {\r\n  let nextKeys = [].concat(selectedRowKeys);\r\n  let nextHalfCheckedKeys = [].concat(halfCheckedKeys);\r\n  let row = flatData.find(d => d[rowKey] === key);\r\n  let parentKeys = [].concat(row.__parents || []);\r\n\r\n  if (selectedRowKeys.indexOf(key) === -1) {\r\n    let halfIndex = nextHalfCheckedKeys.indexOf(key);\r\n    if (halfIndex > -1) {\r\n      nextHalfCheckedKeys.splice(halfIndex, 1);\r\n    }\r\n    nextKeys.push(key);\r\n  }\r\n\r\n  //父级半选的key\r\n  let parentHalfCheckedKeys = [];\r\n\r\n  //子级key\r\n  let childrenSelectedKeys = [];\r\n\r\n  flatData.filter(d => {\r\n    let pArr = d.__parents || [];\r\n    let bl = pArr.indexOf(key) > -1;\r\n    let ck = d[rowKey];\r\n    if (bl) {\r\n      if (selectedRowKeys.indexOf(ck) === -1) {\r\n        childrenSelectedKeys.push(ck);\r\n      }\r\n    }\r\n    return bl;\r\n  });\r\n\r\n  nextKeys = nextKeys.concat(childrenSelectedKeys);\r\n\r\n  for (let i = parentKeys.length - 1; i >= 0; i--) {\r\n    let p = parentKeys[i];\r\n\r\n    let pNode = flatData.find(d => {\r\n      return d[rowKey] === p;\r\n    });\r\n\r\n    let childrens = [];\r\n    if (pNode) {\r\n      childrens = pNode.children || [];\r\n    }\r\n\r\n    //子级是否全被选中\r\n    let childrensAllChecked = true;\r\n\r\n    for (let i = 0; i < childrens.length; i++) {\r\n      const cKey = childrens[i][rowKey];\r\n      if (nextKeys.indexOf(cKey) === -1) {\r\n        childrensAllChecked = false;\r\n        break;\r\n      }\r\n    }\r\n\r\n    //子级全被选中，则勾选其父节点\r\n    if (childrensAllChecked === true) {\r\n      if (nextKeys.indexOf(p) === -1) {\r\n        nextKeys.push(p);\r\n      }\r\n\r\n      //取消半选中父级\r\n      let k = nextHalfCheckedKeys.findIndex(d => d === p);\r\n      if (k > -1) {\r\n        nextHalfCheckedKeys.splice(k, 1);\r\n      }\r\n    } else {\r\n      //未全选，则半选父节点\r\n      if (halfCheckedKeys.indexOf(p) === -1) {\r\n        parentHalfCheckedKeys.push(p);\r\n\r\n        //取消选中父级\r\n        let j = nextKeys.findIndex(d => d === p);\r\n        if (j > -1) {\r\n          nextKeys.splice(j, 1);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  let newHalflCheckedKeys = nextHalfCheckedKeys.concat(parentHalfCheckedKeys);\r\n\r\n  return {\r\n    selectedRowKeys: nextKeys,\r\n    halfCheckedKeys: newHalflCheckedKeys\r\n  };\r\n}\r\n\r\nexport function removeCheckedKey({\r\n  key,\r\n  selectedRowKeys,\r\n  rowKey,\r\n  flatData,\r\n  halfCheckedKeys\r\n}) {\r\n  let nextKeys = [].concat(selectedRowKeys);\r\n  let nextHalfCheckedKeys = [].concat(halfCheckedKeys);\r\n\r\n  let row = flatData.find(d => d[rowKey] === key);\r\n\r\n  let parentKeys = [].concat(row.__parents || []);\r\n\r\n  //父级半选的key\r\n  let parentHalfCheckedKeys = [];\r\n\r\n  //子级key\r\n  let childrenKeys = [];\r\n\r\n  flatData.filter(d => {\r\n    let pArr = d.__parents || [];\r\n    let bl = pArr.indexOf(key) > -1;\r\n    if (bl) {\r\n      childrenKeys.push(d[rowKey]);\r\n    }\r\n    return bl;\r\n  });\r\n\r\n  //移除子级\r\n  if (childrenKeys.length > 0) {\r\n    for (let i = 0; i < childrenKeys.length; i++) {\r\n      const k = childrenKeys[i];\r\n\r\n      //移除选中\r\n      let j = nextKeys.findIndex(d => d === k);\r\n      if (j > -1) {\r\n        nextKeys.splice(j, 1);\r\n      }\r\n\r\n      //移除半选\r\n      let m = nextHalfCheckedKeys.findIndex(d => d === k);\r\n      if (m > -1) {\r\n        nextHalfCheckedKeys.splice(m, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  //移除本级选中\r\n  let i = nextKeys.findIndex(d => d === key);\r\n  if (i > -1) {\r\n    nextKeys.splice(i, 1);\r\n  }\r\n\r\n  //移除本级半选\r\n  let j = nextHalfCheckedKeys.findIndex(d => d === key);\r\n  if (j > -1) {\r\n    nextHalfCheckedKeys.splice(j, 1);\r\n  }\r\n\r\n  for (let i = parentKeys.length - 1; i >= 0; i--) {\r\n    let p = parentKeys[i];\r\n    let childrens = flatData.filter(d => {\r\n      return (d.__parents || []).indexOf(p) > -1;\r\n    });\r\n\r\n    //子级是否全未选中\r\n    let childrensAllUnChecked = true;\r\n\r\n    for (let i = 0; i < childrens.length; i++) {\r\n      const cKey = childrens[i][rowKey];\r\n      if (nextKeys.indexOf(cKey) > -1) {\r\n        childrensAllUnChecked = false;\r\n        break;\r\n      }\r\n    }\r\n\r\n    //子级全未选中，则取消勾选其父节点\r\n    if (childrensAllUnChecked === true) {\r\n      //取消选中父级\r\n      let j = nextKeys.findIndex(d => d === p);\r\n      if (j > -1) {\r\n        nextKeys.splice(j, 1);\r\n      }\r\n\r\n      //取消半选父级\r\n      let k = nextHalfCheckedKeys.findIndex(d => d === p);\r\n      if (k > -1) {\r\n        nextHalfCheckedKeys.splice(k, 1);\r\n      }\r\n    } else {\r\n      //否则半选父节点\r\n      if (halfCheckedKeys.indexOf(p) === -1) {\r\n        parentHalfCheckedKeys.push(p);\r\n\r\n        //取消选中父级\r\n        let j = nextKeys.findIndex(d => d === p);\r\n        if (j > -1) {\r\n          nextKeys.splice(j, 1);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  let newHalflCheckedKeys = nextHalfCheckedKeys.concat(parentHalfCheckedKeys);\r\n\r\n  return {\r\n    selectedRowKeys: nextKeys,\r\n    halfCheckedKeys: newHalflCheckedKeys\r\n  };\r\n}\r\n\r\n/**\r\n * 添加选中行\r\n * @key {Array} 行key\r\n * @selectedRowKeys {Array} 当前选中的行key\r\n * @rowKey {string} 数据行主键key字段名\r\n * @flatData {Array} 展平的表格数据\r\n * @halfCheckedKeys {Array} 当前半选状态的行key\r\n * @disabledSelectKeys {Array} 禁用选择的数据行key\r\n */\r\nexport function addCheckedKeyWithDisabled({\r\n  key,\r\n  selectedRowKeys,\r\n  rowKey,\r\n  flatData,\r\n  halfCheckedKeys,\r\n  disabledSelectKeys = []\r\n}) {\r\n  let nextKeys = [].concat(selectedRowKeys);\r\n  let nextHalfCheckedKeys = [].concat(halfCheckedKeys);\r\n  let row = flatData.find(d => d[rowKey] === key);\r\n  let parentKeys = [].concat(row.__parents || []);\r\n\r\n  /** 是否允许被选择 */\r\n  function isEnabled(itemKey) {\r\n    return disabledSelectKeys.indexOf(itemKey) === -1;\r\n  }\r\n\r\n  //本级是否允许选择\r\n  if (isEnabled(key) === false) {\r\n    return {\r\n      selectedRowKeys,\r\n      halfCheckedKeys\r\n    };\r\n  }\r\n\r\n  //父级是否允许选择\r\n  let parentEnableSelect = true;\r\n  for (let i = 0; i < parentKeys.length; i++) {\r\n    const pk = parentKeys[i];\r\n    if (isEnabled(pk) === false) {\r\n      parentEnableSelect = false;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (parentEnableSelect === false) {\r\n    return {\r\n      selectedRowKeys,\r\n      halfCheckedKeys\r\n    };\r\n  }\r\n\r\n  if (selectedRowKeys.indexOf(key) === -1) {\r\n    let halfIndex = nextHalfCheckedKeys.indexOf(key);\r\n    if (halfIndex > -1) {\r\n      nextHalfCheckedKeys.splice(halfIndex, 1);\r\n    }\r\n\r\n    nextKeys.push(key);\r\n  }\r\n\r\n  //父级半选的key\r\n  let parentHalfCheckedKeys = [];\r\n\r\n  //子级key\r\n  let childrenSelectedKeys = [];\r\n\r\n  flatData.filter(d => {\r\n    let pArr = d.__parents || [];\r\n    let bl = pArr.indexOf(key) > -1;\r\n    let ck = d[rowKey];\r\n    if (bl) {\r\n      if (selectedRowKeys.indexOf(ck) === -1) {\r\n        //子级是否允许被选择\r\n        let isEnableSelect = isEnabled(ck);\r\n\r\n        for (let i = 0; i < pArr.length; i++) {\r\n          const cpk = pArr[i];\r\n          if (isEnabled(cpk) === false) {\r\n            isEnableSelect = false;\r\n            break;\r\n          }\r\n        }\r\n\r\n        isEnableSelect && childrenSelectedKeys.push(ck);\r\n      }\r\n    }\r\n    return bl;\r\n  });\r\n\r\n  nextKeys = nextKeys.concat(childrenSelectedKeys);\r\n\r\n  for (let i = parentKeys.length - 1; i >= 0; i--) {\r\n    let p = parentKeys[i];\r\n\r\n    let pNode = flatData.find(d => {\r\n      return d[rowKey] === p;\r\n    });\r\n\r\n    let childrens = [];\r\n    if (pNode) {\r\n      childrens = pNode.children || [];\r\n    }\r\n\r\n    //子级是否全被选中\r\n    let childrensAllChecked = true;\r\n\r\n    for (let i = 0; i < childrens.length; i++) {\r\n      const cKey = childrens[i][rowKey];\r\n      if (isEnabled(cKey) && nextKeys.indexOf(cKey) === -1) {\r\n        childrensAllChecked = false;\r\n        break;\r\n      }\r\n    }\r\n\r\n    //子级全被选中，则勾选其父节点\r\n    if (childrensAllChecked === true) {\r\n      if (nextKeys.indexOf(p) === -1) {\r\n        isEnabled(p) && nextKeys.push(p);\r\n      }\r\n\r\n      //取消半选中父级\r\n      let k = nextHalfCheckedKeys.findIndex(d => d === p);\r\n      if (k > -1) {\r\n        nextHalfCheckedKeys.splice(k, 1);\r\n      }\r\n    } else {\r\n      //未全选，则半选父节点\r\n      if (halfCheckedKeys.indexOf(p) === -1) {\r\n        isEnabled(p) && parentHalfCheckedKeys.push(p);\r\n\r\n        //取消选中父级\r\n        let j = nextKeys.findIndex(d => d === p);\r\n        if (j > -1) {\r\n          nextKeys.splice(j, 1);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  let newHalflCheckedKeys = nextHalfCheckedKeys.concat(parentHalfCheckedKeys);\r\n\r\n  return {\r\n    selectedRowKeys: nextKeys,\r\n    halfCheckedKeys: newHalflCheckedKeys\r\n  };\r\n}\r\n","function getTime() {\r\n  let cd = new Date();\r\n\r\n  let y = cd.getFullYear();\r\n  let m = cd.getMonth() + 1;\r\n  m = m < 10 ? \"0\" + m : m;\r\n  let d = cd.getDate();\r\n  d = d < 10 ? \"0\" + d : d;\r\n  let h = cd.getHours();\r\n  h = h < 10 ? \"0\" + h : h;\r\n  let mi = cd.getMinutes();\r\n  mi = mi < 10 ? \"0\" + mi : mi;\r\n  let s = cd.getSeconds();\r\n  s = s < 10 ? \"0\" + s : s;\r\n\r\n  return y + \"/\" + m + \"/\" + d + \" \" + h + \":\" + mi + \":\" + s;\r\n}\r\n\r\nlet storageKey = \"__tablex_configs\";\r\nlet tableKey = \"tableId\";\r\nlet serverSaveFunctionName = \"__tablex_configs_save\";\r\n\r\nlet LocalConfig = {\r\n  get: function(key) {\r\n    let allConfigs = JSON.parse(\r\n      window.localStorage.getItem(storageKey) || \"[]\"\r\n    );\r\n    if (key) {\r\n      let config = allConfigs.find(d => d[tableKey] === key);\r\n      let settings = {};\r\n      if (config) {\r\n        if (typeof config === \"string\") {\r\n          settings = JSON.parse(config);\r\n        } else {\r\n          settings = config;\r\n        }\r\n      }\r\n      return settings;\r\n    }\r\n    return allConfigs;\r\n  },\r\n\r\n  set: function(key, configs) {\r\n    configs = Object.assign(configs, {\r\n      time: getTime(),\r\n      [tableKey]: key\r\n    });\r\n\r\n    let allConfigs = LocalConfig.get();\r\n    let i = allConfigs.findIndex(d => d[tableKey] === key);\r\n\r\n    if (i > -1) {\r\n      allConfigs[i] = Object.assign(allConfigs[i], configs);\r\n    } else {\r\n      allConfigs.push(configs);\r\n    }\r\n    window.localStorage.setItem(storageKey, JSON.stringify(allConfigs));\r\n    return configs;\r\n  },\r\n  remove: function(key) {\r\n    let allConfigs = LocalConfig.get();\r\n    let i = allConfigs.findIndex(d => d[tableKey] === key);\r\n    if (i > -1) {\r\n      allConfigs.splice(i, 1);\r\n      window.localStorage.setItem(storageKey, JSON.stringify(allConfigs));\r\n    }\r\n  }\r\n};\r\n\r\nexport function getConfigs(key) {\r\n  return LocalConfig.get(key);\r\n}\r\n\r\nexport function setConfigs(key, configs) {\r\n  return LocalConfig.set(key, configs);\r\n}\r\n\r\n//配置窗口 保存\r\nexport function saveConfigs(key, configs) {\r\n  let settedConfigs = LocalConfig.set(key, configs);\r\n\r\n  let serverSaveFn = window[serverSaveFunctionName];\r\n\r\n  return new Promise(function(resolve, reject) {\r\n    if (typeof serverSaveFn === \"function\") {\r\n      serverSaveFn(key, settedConfigs).then(d => {\r\n        resolve();\r\n      });\r\n    } else {\r\n      resolve();\r\n    }\r\n  });\r\n}\r\n\r\n//配置窗口 重置\r\nexport function removeConfigs(key) {\r\n  let serverSaveFn = window[serverSaveFunctionName];\r\n\r\n  return new Promise(function(resolve, reject) {\r\n    if (typeof serverSaveFn === \"function\") {\r\n      serverSaveFn(key, \"\").then(d => {\r\n        LocalConfig.remove(key);\r\n        resolve();\r\n      });\r\n    } else {\r\n      LocalConfig.remove(key);\r\n      resolve();\r\n    }\r\n  });\r\n}\r\n\r\nexport function treeToList(arr) {\r\n  let treeList = arr || [];\r\n\r\n  //末级节点\r\n  let leafs = [];\r\n\r\n  //根\r\n  let roots = [];\r\n\r\n  //所有节点\r\n  let list = [];\r\n\r\n  for (let i = 0; i < treeList.length; i++) {\r\n    const d = treeList[i];\r\n\r\n    if (!d) {\r\n      continue;\r\n    }\r\n\r\n    const childrens = d.children || [];\r\n\r\n    list.push(d);\r\n    roots.push(d);\r\n\r\n    if (childrens.length > 0) {\r\n      getChildren(d);\r\n    } else {\r\n      leafs.push(d);\r\n    }\r\n  }\r\n\r\n  function getChildren(d) {\r\n    const tempArr = d.children || [];\r\n\r\n    for (let i = 0; i < tempArr.length; i++) {\r\n      const d = tempArr[i];\r\n      const childrens = d.children || [];\r\n\r\n      list.push(d);\r\n\r\n      if (childrens.length > 0) {\r\n        getChildren(d);\r\n      } else {\r\n        leafs.push(d);\r\n      }\r\n    }\r\n  }\r\n\r\n  return { list, leafs, roots };\r\n}\r\n\r\nexport function treeForEach(arr, fn) {\r\n  let treeList = arr || [];\r\n\r\n  for (let i = 0; i < treeList.length; i++) {\r\n    const d = treeList[i];\r\n\r\n    let bl = fn(d, i);\r\n\r\n    if (bl === false) {\r\n      break;\r\n    }\r\n\r\n    if (d.children && d.children.length > 0) {\r\n      getChildren(d);\r\n    }\r\n  }\r\n\r\n  function getChildren(node) {\r\n    const tempArr = node.children || [];\r\n\r\n    for (let i = 0; i < tempArr.length; i++) {\r\n      const d = tempArr[i];\r\n\r\n      let bl = fn(d, i);\r\n\r\n      if (bl === false) {\r\n        break;\r\n      }\r\n\r\n      if (d.children && d.children.length > 0) {\r\n        getChildren(d);\r\n      }\r\n    }\r\n  }\r\n\r\n  return treeList;\r\n}\r\n","import React, { Component } from \"react\";\r\nimport Modal from \"antd/lib/modal\";\r\nimport Button from \"antd/lib/button\";\r\nimport InputNumber from \"antd/lib/input-number\";\r\nimport Radio from \"antd/lib/radio\";\r\nimport Switch from \"antd/lib/switch\";\r\nimport { saveConfigs, removeConfigs, treeToList } from \"./utils\";\r\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\r\nimport cloneDeep from \"lodash/cloneDeep\";\r\nimport orderBy from \"lodash/orderBy\";\r\n\r\nconst RadioGroup = Radio.Group;\r\nconst RadioButton = Radio.Button;\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const result = Array.from(list);\r\n  const [removed] = result.splice(startIndex, 1);\r\n  result.splice(endIndex, 0, removed);\r\n\r\n  return result;\r\n};\r\n\r\nconst getItemStyle = (isDragging, draggableStyle) => ({\r\n  userSelect: \"none\",\r\n  padding: 5,\r\n\r\n  background: isDragging ? \"#fce2c9\" : \"none\",\r\n  width: \"100%\",\r\n  ...draggableStyle\r\n});\r\n\r\nconst getListStyle = () => ({\r\n  width: \"100%\"\r\n});\r\n\r\nclass SortableItem extends Component {\r\n  onChangeWidth = e => {\r\n    let { onChangeWidth, data } = this.props;\r\n    onChangeWidth(e, data);\r\n  };\r\n\r\n  onChangeFixed = e => {\r\n    let { onChangeFixed, data } = this.props;\r\n    onChangeFixed(e, data);\r\n  };\r\n\r\n  onToggleVisible = e => {\r\n    let { onToggleVisible, data } = this.props;\r\n    onToggleVisible(e, data);\r\n  };\r\n\r\n  render() {\r\n    let itemStyles = {\r\n      display: \"inline-block\",\r\n      marginLeft: 10\r\n    };\r\n\r\n    let d = this.props.data;\r\n\r\n    return (\r\n      <div\r\n        style={{\r\n          borderBottom: \"1px solid #e8e8e8\",\r\n          width: \"100%\",\r\n          marginBottom: 5,\r\n          paddingBottom: 10\r\n        }}\r\n      >\r\n        <div\r\n          style={{\r\n            display: \"inline-block\",\r\n            width: \"30%\",\r\n            fontWeight: \"bold\",\r\n            padding: \"5px 0 0px 0px\"\r\n          }}\r\n        >\r\n          {d.title}\r\n        </div>\r\n        <div\r\n          style={{ display: \"inline-block\", width: \"70%\", textAlign: \"right\" }}\r\n        >\r\n          <div style={itemStyles}>\r\n            宽度：\r\n            <InputNumber\r\n              value={d.width}\r\n              style={{ width: 80 }}\r\n              onChange={this.onChangeWidth}\r\n            />\r\n          </div>\r\n          <div style={itemStyles}>\r\n            冻结：\r\n            <RadioGroup\r\n              size=\"small\"\r\n              value={d.fixed || \"none\"}\r\n              onChange={this.onChangeFixed}\r\n            >\r\n              <RadioButton value=\"left\">左</RadioButton>\r\n              <RadioButton value=\"none\">无</RadioButton>\r\n              <RadioButton value=\"right\">右</RadioButton>\r\n            </RadioGroup>\r\n          </div>\r\n\r\n          <div style={{ ...itemStyles, position: \"relative\", bottom: \"2px\" }}>\r\n            <Switch\r\n              checkedChildren=\"显示\"\r\n              checked={!d.hidden}\r\n              unCheckedChildren=\"隐藏\"\r\n              onChange={this.onToggleVisible}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass SortableList extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      items: []\r\n    };\r\n    this.onDragEnd = this.onDragEnd.bind(this);\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, prevState) {\r\n    return { items: nextProps.items };\r\n  }\r\n\r\n  onDragEnd(result) {\r\n    if (!result.destination) {\r\n      return;\r\n    }\r\n\r\n    const items = reorder(\r\n      this.state.items,\r\n      result.source.index,\r\n      result.destination.index\r\n    );\r\n\r\n    this.props.onSort(items);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <DragDropContext onDragEnd={this.onDragEnd}>\r\n        <Droppable droppableId=\"droppable\">\r\n          {(provided, snapshot) => (\r\n            <div\r\n              ref={provided.innerRef}\r\n              style={getListStyle(snapshot.isDraggingOver)}\r\n            >\r\n              {this.state.items.map((item, index) => (\r\n                <Draggable\r\n                  key={item.key || item.dataIndex}\r\n                  draggableId={item.key || item.dataIndex}\r\n                  index={index}\r\n                >\r\n                  {(provided, snapshot) => (\r\n                    <div\r\n                      ref={provided.innerRef}\r\n                      {...provided.draggableProps}\r\n                      {...provided.dragHandleProps}\r\n                      style={getItemStyle(\r\n                        snapshot.isDragging,\r\n                        provided.draggableProps.style\r\n                      )}\r\n                    >\r\n                      <SortableItem\r\n                        data={item}\r\n                        onChangeWidth={this.props.onChangeWidth}\r\n                        onChangeFixed={this.props.onChangeFixed}\r\n                        onToggleVisible={this.props.onToggleVisible}\r\n                      />\r\n                    </div>\r\n                  )}\r\n                </Draggable>\r\n              ))}\r\n              {provided.placeholder}\r\n            </div>\r\n          )}\r\n        </Droppable>\r\n      </DragDropContext>\r\n    );\r\n  }\r\n}\r\n\r\nclass SettingModal extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      propsOriginal: {},\r\n      visible: false,\r\n      loading: false,\r\n      resetLoading: false,\r\n      configs: {},\r\n      rawConfigs: {},\r\n      columns: [],\r\n      columnsOriginal: [],\r\n      columnsLeafs: []\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, prevState) {\r\n    if (prevState.propsOriginal !== nextProps) {\r\n      let nextState = {};\r\n\r\n      nextState.propsOriginal = nextProps;\r\n\r\n      let arr = nextProps.columns || [];\r\n\r\n      nextState.columnsOriginal = arr;\r\n\r\n      let columns = cloneDeep(arr);\r\n\r\n      nextState.rawConfigs = nextProps.configs || {};\r\n      let configs = cloneDeep(nextProps.configs || {});\r\n\r\n      let { leafs } = treeToList(columns);\r\n\r\n      leafs.forEach((d, i) => {\r\n        let columnKey = d.key || d.dataIndex;\r\n        let config = configs[columnKey] || {};\r\n        if (\"fixed\" in config) {\r\n          d.fixed = config.fixed;\r\n        }\r\n        if (\"width\" in config) {\r\n          d.width = config.width;\r\n        }\r\n        if (\"hidden\" in config) {\r\n          d.hidden = config.hidden;\r\n        }\r\n\r\n        if (\"order\" in config) {\r\n          d.order = config.order;\r\n        } else {\r\n          d.order = i;\r\n        }\r\n      });\r\n\r\n      let columnsArr = orderBy(columns, [\"order\"], [\"asc\"]);\r\n      nextState.columns = columnsArr;\r\n\r\n      leafs = orderBy(leafs, [\"order\"], [\"asc\"]);\r\n\r\n      nextState.columnsLeafs = leafs;\r\n\r\n      nextState.configs = configs;\r\n\r\n      return nextState;\r\n    } else {\r\n      let nextState = {};\r\n\r\n      let columns = prevState.columns;\r\n      let { leafs } = treeToList(columns);\r\n      let configs = prevState.configs;\r\n\r\n      leafs.forEach((d, i) => {\r\n        let columnKey = d.key || d.dataIndex;\r\n        let config = configs[columnKey] || {};\r\n        if (\"fixed\" in config) {\r\n          d.fixed = config.fixed;\r\n        }\r\n        if (\"width\" in config) {\r\n          d.width = config.width;\r\n        }\r\n        if (\"hidden\" in config) {\r\n          d.hidden = config.hidden;\r\n        }\r\n\r\n        if (\"order\" in config) {\r\n          d.order = config.order;\r\n        } else {\r\n          d.order = i;\r\n        }\r\n      });\r\n\r\n      leafs = orderBy(leafs, [\"order\"], [\"asc\"]);\r\n      nextState.columnsLeafs = leafs;\r\n\r\n      return nextState;\r\n    }\r\n  }\r\n\r\n  saveSettings = () => {\r\n    var { tableId, onSave, groupedColumnKey } = this.props;\r\n\r\n    if (!tableId) {\r\n      return;\r\n    }\r\n\r\n    this.setState({ loading: true });\r\n\r\n    let { configs } = this.state;\r\n\r\n    saveConfigs(tableId, {\r\n      columnsConfig: configs\r\n    }).then(d => {\r\n      if (typeof onSave === \"function\") {\r\n        onSave(configs);\r\n      }\r\n      this.setState({ loading: false, visible: false });\r\n    });\r\n  };\r\n\r\n  reset = () => {\r\n    var { tableId, onReset } = this.props;\r\n\r\n    if (!tableId) {\r\n      return;\r\n    }\r\n\r\n    this.setState({ resetLoading: true });\r\n\r\n    removeConfigs(tableId).then(d => {\r\n      if (typeof onReset === \"function\") {\r\n        onReset();\r\n      }\r\n      this.setState({ resetLoading: false });\r\n    });\r\n  };\r\n\r\n  toggle = () => {\r\n    let v = !this.state.visible;\r\n    this.setState({ visible: v });\r\n  };\r\n\r\n  onOk = () => {\r\n    this.saveSettings();\r\n  };\r\n\r\n  onCancel = () => {\r\n    this.setState({\r\n      visible: false,\r\n      columns: cloneDeep(this.state.columnsOriginal),\r\n      configs: cloneDeep(this.state.rawConfigs)\r\n    });\r\n  };\r\n\r\n  setConfig = (column, config) => {\r\n    let configs = this.state.configs || {};\r\n\r\n    let columnKey = column.key || column.dataIndex;\r\n\r\n    let prevConfig = configs[columnKey] || {};\r\n    let nextConfig = {\r\n      [columnKey]: Object.assign({}, prevConfig, config)\r\n    };\r\n\r\n    this.setState({\r\n      configs: { ...configs, ...nextConfig }\r\n    });\r\n  };\r\n\r\n  onChangeWidth = (value, column) => {\r\n    this.setConfig(column, { width: value });\r\n  };\r\n\r\n  onChangeFixed = (e, column) => {\r\n    this.setConfig(column, { fixed: e.target.value });\r\n  };\r\n\r\n  onToggleVisible = (bl, column) => {\r\n    this.setConfig(column, { hidden: !bl });\r\n  };\r\n\r\n  onSort = items => {\r\n    let configs = this.state.configs || {};\r\n\r\n    items.forEach((d, index) => {\r\n      // d.order = index;\r\n\r\n      let columnKey = d.key || d.dataIndex;\r\n      let config = configs[columnKey];\r\n      if (config) {\r\n        config.order = index;\r\n      } else {\r\n        configs[columnKey] = { order: index };\r\n      }\r\n    });\r\n\r\n    this.setState({ configs });\r\n  };\r\n\r\n  render() {\r\n    let { visible, columnsLeafs } = this.state;\r\n\r\n    let leafs = columnsLeafs.filter(d => d.settable !== false);\r\n\r\n    let attrs = {\r\n      visible: visible,\r\n      title: \"表格配置\",\r\n      onOk: this.onOk,\r\n      onCancel: this.onCancel,\r\n      width: \"720px\",\r\n      bodyStyle: {\r\n        minHeight: \"300px\",\r\n        maxHeight: \"500px\",\r\n        overflow: \"auto\"\r\n      },\r\n      maskClosable: false,\r\n      footer: (\r\n        <div style={{ textAlign: \"center\" }}>\r\n          <Button\r\n            type=\"primary\"\r\n            loading={this.state.resetLoading}\r\n            onClick={this.reset}\r\n          >\r\n            重置\r\n          </Button>\r\n          <Button\r\n            loading={this.state.loading}\r\n            type=\"primary\"\r\n            onClick={this.onOk}\r\n            style={{ marginLeft: 20 }}\r\n          >\r\n            确定\r\n          </Button>\r\n          <Button style={{ marginLeft: 20 }} onClick={this.onCancel}>\r\n            取消\r\n          </Button>\r\n        </div>\r\n      )\r\n    };\r\n\r\n    return (\r\n      <Modal {...attrs}>\r\n        <SortableList\r\n          items={leafs}\r\n          onSort={this.onSort}\r\n          onChangeWidth={this.onChangeWidth}\r\n          onChangeFixed={this.onChangeFixed}\r\n          onToggleVisible={this.onToggleVisible}\r\n        />\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SettingModal;\r\n","import React, { useRef } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport Button from \"antd/lib/button\";\r\nimport Modal from \"./modal\";\r\nimport { getConfigs, setConfigs } from \"./utils\";\r\n\r\nconst Setting = props => {\r\n  const modalRef = useRef();\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Button\r\n        icon=\"setting\"\r\n        onClick={() => {\r\n          modalRef.current.toggle();\r\n        }}\r\n      />\r\n      {createPortal(<Modal {...props} ref={modalRef} />, document.body)}\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default Setting;\r\nexport { getConfigs };\r\nexport { setConfigs };\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport Table from \"react-base-datagrid\";\r\n\r\nimport Pagination from \"./pagination\";\r\nimport Spin from \"antd/lib/spin\";\r\nimport ColumnDropMenu from \"./ColumnDropMenu\";\r\nimport {\r\n  treeToFlatten as treeToList,\r\n  treeFilter,\r\n  getParentElement\r\n} from \"./utils\";\r\nimport Setting, { getConfigs, setConfigs } from \"./setting\";\r\nimport orderBy from \"lodash/orderBy\";\r\nimport Popover from \"antd/lib/popover\";\r\nimport cloneDeep from \"lodash/cloneDeep\";\r\n\r\n/**\r\n * 表格\r\n */\r\nclass FeaturedTable extends React.Component {\r\n  dropdown_button_ref = React.createRef();\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    let configs = {};\r\n\r\n    if (props.tableId) {\r\n      configs = getConfigs(props.tableId) || {};\r\n    }\r\n\r\n    this.state = {\r\n      prevProps: null,\r\n      pagination: false,\r\n      data: [],\r\n      columns: [],\r\n      columnsConfig: configs.columnsConfig || null,\r\n      columnMenu: null\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, prevState) {\r\n    let nextState = {};\r\n\r\n    if (prevState.prevProps !== nextProps) {\r\n      let columns = cloneDeep(nextProps.columns || []);\r\n      nextState.columns = columns;\r\n      nextState.data = nextProps.data || nextProps.dataSource || [];\r\n      nextState.rawColumns = nextProps.columns || [];\r\n      nextState.prevProps = nextProps;\r\n    }\r\n\r\n    if (\"pagination\" in nextProps) {\r\n      nextState.pagination = nextProps.pagination;\r\n\r\n      const newPagination = {\r\n        ...prevState.pagination,\r\n        ...nextProps.pagination\r\n      };\r\n      newPagination.current = newPagination.current || 1;\r\n      newPagination.pageSize = newPagination.pageSize || 10;\r\n\r\n      if (nextProps.pagination !== false) {\r\n        nextState.pagination = newPagination;\r\n      } else {\r\n        nextState.pagination = {};\r\n      }\r\n\r\n      return nextState;\r\n    }\r\n\r\n    if (Object.keys(nextState).length === 0) {\r\n      return null;\r\n    }\r\n\r\n    return nextState;\r\n  }\r\n\r\n  hasPagination() {\r\n    return this.props.pagination !== false;\r\n  }\r\n\r\n  onPageChange = (pageIndex, pageSize) => {\r\n    let { pagination } = this.state;\r\n    let fn = this.state.pagination.onPageChange;\r\n\r\n    if (typeof fn === \"function\") {\r\n      fn(pageIndex, pageSize);\r\n    } else {\r\n      this.setState({\r\n        pagination: {\r\n          ...pagination,\r\n          current: pageIndex,\r\n          pageSize\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  getMaxCurrent(total) {\r\n    const {\r\n      pagination: { current, pageSize }\r\n    } = this.state;\r\n    if ((current - 1) * pageSize >= total) {\r\n      return Math.floor((total - 1) / pageSize) + 1;\r\n    }\r\n    return current;\r\n  }\r\n\r\n  getCurrentPageData(data) {\r\n    let current;\r\n    let pageSize;\r\n    const state = this.state;\r\n    // 如果没有分页的话，默认全部展示\r\n    if (!this.hasPagination()) {\r\n      pageSize = data.length;\r\n      current = 1;\r\n    } else {\r\n      pageSize = state.pagination.pageSize;\r\n      current = this.getMaxCurrent(state.pagination.total || data.length);\r\n    }\r\n\r\n    // 分页\r\n    // ---\r\n    // 当数据量少于等于每页数量时，直接设置数据\r\n    // 否则进行读取分页数据\r\n    if (data.length > pageSize) {\r\n      data = data.filter((_, i) => {\r\n        return i >= (current - 1) * pageSize && i < current * pageSize;\r\n      });\r\n    }\r\n\r\n    return data;\r\n  }\r\n\r\n  columnSettingMenuShow = e => {\r\n    e.target.className = \"tablex__column__inner__dropdown opened\";\r\n\r\n    let el = e.target;\r\n\r\n    let container = getParentElement(el, \".tablex-table-head\");\r\n    let p = getParentElement(e.target, \".tablex-table-head-cell\");\r\n    let sl = 0;\r\n    if (container) {\r\n      sl = container.scrollLeft;\r\n    }\r\n\r\n    let left = 0;\r\n    let top = 0;\r\n    if (p) {\r\n      left = p.offsetLeft + p.offsetWidth - sl - el.offsetWidth;\r\n      top = p.offsetTop + p.offsetHeight - p.offsetHeight / 2 + 6;\r\n    }\r\n\r\n    if (this.dropdown_button_ref && this.dropdown_button_ref.current) {\r\n      this.dropdown_button_ref.current.click();\r\n    }\r\n\r\n    this.setState({\r\n      columnMenu: {\r\n        columnKey: e.target.dataset.columnkey,\r\n        trigger: e.target,\r\n        visible: true,\r\n        offsetX: left,\r\n        offsetY: top\r\n      }\r\n    });\r\n  };\r\n\r\n  columnSettingMenuHide = () => {\r\n    let columnMenu = this.state.columnMenu || {};\r\n    if (columnMenu.trigger) {\r\n      columnMenu.trigger.className = \"tablex__column__inner__dropdown\";\r\n    }\r\n    this.setState({\r\n      columnMenu: Object.assign(columnMenu, { visible: false, trigger: null })\r\n    });\r\n  };\r\n\r\n  onColumnResize = (width, columnKey) => {\r\n    this.onColumnChange(columnKey, { width });\r\n  };\r\n\r\n  onColumnChange = (key, config) => {\r\n    let columnKey = key;\r\n\r\n    let { columnsConfig, columnMenu } = this.state;\r\n\r\n    let configs = columnsConfig || {};\r\n\r\n    if (!columnKey && columnMenu) {\r\n      columnKey = columnMenu.columnKey;\r\n    }\r\n\r\n    let prevConfig = configs[columnKey] || {};\r\n    let nextConfig = {\r\n      [columnKey]: Object.assign({}, prevConfig, config)\r\n    };\r\n\r\n    let newConfigs = { ...configs, ...nextConfig };\r\n\r\n    setConfigs(this.props.tableId, {\r\n      columnsConfig: newConfigs,\r\n      groupedColumnKey: null\r\n    });\r\n\r\n    this.setState({\r\n      columnsConfig: newConfigs\r\n    });\r\n  };\r\n\r\n  formatColumns = () => {\r\n    let { columns, columnsConfig } = this.state;\r\n\r\n    let configs = columnsConfig || {};\r\n\r\n    let arr = columns;\r\n\r\n    arr = treeFilter(columns, d => {\r\n      let columnKey = d.key || d.dataIndex;\r\n      let bl = true;\r\n\r\n      d.key = columnKey;\r\n      let config = configs[columnKey] || {};\r\n      bl = !config.hidden;\r\n\r\n      return bl;\r\n    });\r\n\r\n    let cols = treeToList(arr).leafs;\r\n\r\n    cols.forEach((d, i) => {\r\n      let columnKey = d.key || d.dataIndex;\r\n      let config = configs[columnKey] || configs[columnKey] || {};\r\n\r\n      if (\"fixed\" in config) {\r\n        d.fixed = config.fixed;\r\n      }\r\n\r\n      if (\"width\" in config) {\r\n        d.width = config.width;\r\n      }\r\n\r\n      if (\"order\" in config) {\r\n        d.order = config.order;\r\n      } else {\r\n        d.order = i;\r\n      }\r\n\r\n      d.headRender = ({ column }) => {\r\n        return (\r\n          <div className=\"tablex__column__inner\">\r\n            <span className=\"tablex__column__inner__title\">{column.title}</span>\r\n            <span\r\n              className=\"tablex__column__inner__dropdown\"\r\n              data-columnkey={columnKey}\r\n              onClick={this.columnSettingMenuShow}\r\n            />\r\n          </div>\r\n        );\r\n      };\r\n    });\r\n\r\n    arr = orderBy(arr, [\"order\"], [\"asc\"]);\r\n\r\n    return cloneDeep(arr);\r\n  };\r\n\r\n  saveConfig = configs => {\r\n    this.setState({ columnsConfig: configs });\r\n  };\r\n\r\n  resetConfig = () => {\r\n    this.setState({ columnsConfig: {} });\r\n  };\r\n\r\n  renderHeader = () => {\r\n    let header = null;\r\n\r\n    let headerExtra = null;\r\n\r\n    if (typeof this.props.header === \"function\") {\r\n      headerExtra = this.props.header();\r\n    }\r\n\r\n    if (headerExtra) {\r\n      header = <div className=\"tablex__container__header\">{headerExtra}</div>;\r\n    }\r\n\r\n    return header;\r\n  };\r\n\r\n  renderFooter = () => {\r\n    let footer = null;\r\n\r\n    let { pagination: pageAttr, data } = this.state;\r\n\r\n    let { settable, tableId } = this.props;\r\n\r\n    let footerExtra = null;\r\n\r\n    if (typeof this.props.footer === \"function\") {\r\n      footerExtra = this.props.footer();\r\n    }\r\n\r\n    const dataTotal = pageAttr.total || data.length;\r\n\r\n    let hasPager = this.hasPagination();\r\n\r\n    let pager = null;\r\n    let settingButton = null;\r\n\r\n    if (settable === true && tableId) {\r\n      settingButton = (\r\n        <div key=\"_settingButton\" style={{ marginRight: \"5px\" }}>\r\n          <Setting\r\n            tableId={tableId}\r\n            onSave={this.saveConfig}\r\n            onReset={this.resetConfig}\r\n            configs={this.state.columnsConfig}\r\n            columns={this.state.rawColumns}\r\n          />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (hasPager) {\r\n      pager = (\r\n        <Pagination\r\n          {...pageAttr}\r\n          total={dataTotal}\r\n          onPageChange={this.onPageChange}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (pager !== null || settingButton !== null || footerExtra !== null) {\r\n      footer = (\r\n        <div className=\"tablex__container__footer\">\r\n          {settingButton}\r\n          {footerExtra}\r\n          {pager}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return footer;\r\n  };\r\n\r\n  overlayRenderer = () => {\r\n    return (\r\n      <Spin\r\n        spinning={true}\r\n        tip=\"数据加载中，请稍候...\"\r\n        style={{\r\n          position: \"absolute\",\r\n          margin: \"auto\",\r\n          left: 0,\r\n          right: 0,\r\n          width: 300,\r\n          height: 50,\r\n          top: 0,\r\n          bottom: 0,\r\n          zIndex: 2\r\n        }}\r\n      />\r\n    );\r\n  };\r\n  emptyRenderer = () => {\r\n    return <div className=\"tablex__emptydata\">暂无数据</div>;\r\n  };\r\n\r\n  rowClassName = (rowData, rowIndex) => {\r\n    let cls = \"\";\r\n    if (rowIndex % 2 === 0) {\r\n      cls = \"tablex__row--even\";\r\n    } else {\r\n      cls = \"tablex__row--odd\";\r\n    }\r\n\r\n    return cls;\r\n  };\r\n\r\n  render() {\r\n    let props = this.props;\r\n\r\n    let { columnMenu, data } = this.state;\r\n\r\n    let columns = this.formatColumns();\r\n\r\n    let arr = data;\r\n    if (this.hasPagination()) {\r\n      arr = this.getCurrentPageData(data);\r\n    }\r\n\r\n    let newProps = {\r\n      data: arr,\r\n      columns,\r\n      onColumnResizeStop: this.onColumnResize,\r\n      emptyRenderer: this.emptyRenderer\r\n    };\r\n\r\n    if (props.striped === true) {\r\n      newProps.rowClassName = this.rowClassName;\r\n      newProps.className = \"tablex__striped\";\r\n    }\r\n\r\n    if (this.props.loading === true) {\r\n      newProps.overlayRenderer = this.overlayRenderer;\r\n    }\r\n\r\n    let columnMenuState = columnMenu || {};\r\n\r\n    return (\r\n      <div className=\"tablex__container\">\r\n        {this.renderHeader()}\r\n        <div className=\"tablex__container__body\">\r\n          <Table {...props} {...newProps} />\r\n        </div>\r\n        {this.renderFooter()}\r\n\r\n        <Popover\r\n          trigger=\"click\"\r\n          onVisibleChange={this.columnSettingMenuHide}\r\n          content={\r\n            <ColumnDropMenu\r\n              options={{ pinable: true, filterable: true, groupable: false }}\r\n              columns={this.state.columns}\r\n              columnsConfig={this.state.columnsConfig}\r\n              onChange={this.onColumnChange}\r\n            />\r\n          }\r\n          arrowPointAtCenter={true}\r\n          placement=\"bottomRight\"\r\n        >\r\n          <span\r\n            style={{\r\n              width: 1,\r\n              height: 1,\r\n              position: \"absolute\",\r\n              left: columnMenuState.offsetX,\r\n              top: columnMenuState.offsetY,\r\n              display: columnMenuState.visible ? \"block\" : \"none\"\r\n            }}\r\n            ref={this.dropdown_button_ref}\r\n          />\r\n        </Popover>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nFeaturedTable.defaultProps = {\r\n  orderNumber: true,\r\n  settable: true,\r\n  pagination: false,\r\n  loading: false,\r\n  striped: true\r\n};\r\n\r\nFeaturedTable.propTypes = {\r\n  /** 数据是否加载中 */\r\n  loading: PropTypes.bool,\r\n\r\n  /** 是否显示序号 */\r\n  orderNumber: PropTypes.bool,\r\n\r\n  /** 分页 */\r\n  pagination: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\r\n\r\n  /** 是否可进行属性设置 */\r\n  settable: PropTypes.bool,\r\n\r\n  /** 奇偶行颜色间隔 */\r\n  striped: PropTypes.bool,\r\n\r\n  /** 表格全局id，通过此id记忆表格配置，由于采用localStorage存储配置，需保证id唯一 */\r\n  tableId: function(props, propName, componentName) {\r\n    let count = 0;\r\n    let v = props[propName];\r\n\r\n    if (typeof v !== \"undefined\" && v !== \"\") {\r\n      let tbs = document.getElementsByClassName(\"table-extend\");\r\n\r\n      for (let i = 0, len = tbs.length; i < len; i++) {\r\n        const tb = tbs[i];\r\n        if (tb) {\r\n          const t = tb.getAttribute(\"data-tableid\");\r\n          if (t === v) {\r\n            count = count + 1;\r\n\r\n            if (count > 1) {\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (count > 1) {\r\n      return new Error(\r\n        ` Encountered two table with the same tableId, '${v}'.The tableId must be unique in the whole application.\r\n                  We Recommended set the tableId based on file path.\r\n                  eg: platform/user/index.js =>  platform-user-xxx `\r\n      );\r\n    }\r\n  }\r\n};\r\n\r\nexport default FeaturedTable;\r\n","import React from \"react\";\r\nimport ReactDom from \"react-dom\";\r\nimport cloneDeep from \"lodash/cloneDeep\";\r\nimport merge from \"lodash/merge\";\r\nimport Table from \"./Table\";\r\nimport { treeToFlatten as treeToList, treeFilter } from \"./utils\";\r\nimport Tooltip from \"antd/lib/tooltip\";\r\nimport Button from \"antd/lib/button\";\r\nimport message from \"antd/lib/message\";\r\nimport Popconfirm from \"antd/lib/popconfirm\";\r\nimport Menu from \"antd/lib/menu\";\r\nimport Dropdown from \"antd/lib/dropdown\";\r\nimport Icon from \"antd/lib/icon\";\r\nimport \"antd/dist/antd.css\";\r\nimport orderBy from \"lodash/orderBy\";\r\n\r\n/**\r\n * 表格\r\n */\r\nclass EditableTable extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      rowKey: props.rowKey,\r\n      propsOriginal: {},\r\n      rawColumns: [],\r\n      columns: [],\r\n      data: [],\r\n      dataList: [],\r\n      sourceData: [],\r\n      changedRows: [],\r\n      isEditAll: false,\r\n      isAdding: false,\r\n      isAddingRange: false,\r\n      addedData: [],\r\n      isEditing: false,\r\n      editKeys: [],\r\n      editSaveLoading: false,\r\n      deleteLoading: false,\r\n      dataControled: false\r\n    };\r\n  }\r\n\r\n  rowsAttributes = [];\r\n  tableRef = null;\r\n  initRef = inst => {\r\n    if (typeof this.props.initRef === \"function\") {\r\n      this.props.initRef(inst);\r\n    }\r\n    this.tableRef = inst;\r\n  };\r\n\r\n  isEditing = () => {\r\n    return this.state.isEditing;\r\n  };\r\n\r\n  static getDerivedStateFromProps(nextProps, prevState) {\r\n    let nextState = {};\r\n\r\n    //是否让数据受控\r\n    nextState.dataControled = nextProps.dataControled || false;\r\n    //\r\n    let columns = cloneDeep(nextProps.columns || []);\r\n    let columnList = treeToList(columns).list;\r\n    nextState.columns = columns;\r\n    nextState.columnList = columnList;\r\n    nextState.rawColumns = nextProps.columns || [];\r\n\r\n    let data = nextProps.data || nextProps.dataSource;\r\n\r\n    if (prevState.propsOriginal !== nextProps) {\r\n      nextState.propsOriginal = nextProps;\r\n\r\n      nextState.changedRows = [];\r\n\r\n      if (prevState.dataControled === true) {\r\n        let newData = data || [];\r\n        let dataList = treeToList(newData).list;\r\n        nextState.dataList = dataList;\r\n        nextState.data = newData;\r\n        nextState.sourceData = cloneDeep(newData);\r\n      } else {\r\n        if (prevState.sourceData !== data) {\r\n          let newData = data || [];\r\n          let dataList = treeToList(newData).list;\r\n          nextState.dataList = dataList;\r\n          nextState.data = newData;\r\n          nextState.sourceData = cloneDeep(newData);\r\n        }\r\n      }\r\n    }\r\n    return nextState;\r\n  }\r\n\r\n  updateComponent = () => {\r\n    let { data, dataList, addedData } = this.state;\r\n\r\n    this.setState({\r\n      data: cloneDeep(data),\r\n      dataList: cloneDeep(dataList),\r\n      addedData: cloneDeep(addedData)\r\n    });\r\n  };\r\n\r\n  delayTimer = null;\r\n  delayUpdate = fn => {\r\n    let delay = 300;\r\n\r\n    if (typeof this.props.validateDelay === \"number\") {\r\n      delay = this.props.validateDelay;\r\n    }\r\n\r\n    if (this.delayTimer) {\r\n      clearTimeout(this.delayTimer);\r\n    }\r\n\r\n    if (typeof fn === \"function\") {\r\n      this.delayTimer = setTimeout(() => {\r\n        fn();\r\n        this.updateComponent();\r\n      }, delay);\r\n    } else {\r\n      this.delayTimer = setTimeout(this.updateComponent, delay);\r\n    }\r\n  };\r\n\r\n  isMouseFocus = false;\r\n\r\n  changedRows = [];\r\n  addToChanged = newRow => {\r\n    let rowKey = this.props.rowKey;\r\n    let changedRows = this.changedRows;\r\n    let validateTrigger = this.props.validateTrigger;\r\n\r\n    let i = changedRows.findIndex(d => d[rowKey] === newRow[rowKey]);\r\n\r\n    if (i >= 0) {\r\n      changedRows[i] = newRow;\r\n    } else {\r\n      changedRows.push(newRow);\r\n    }\r\n\r\n    this.changedRows = changedRows;\r\n\r\n    // 当change时立即验证行\r\n    if (validateTrigger === \"onChange\") {\r\n      this.validateRow(newRow);\r\n      this.updateComponent();\r\n    }\r\n  };\r\n\r\n  editChange = (newValues = {}, row, index) => {\r\n    let { data, addedData } = this.state;\r\n\r\n    let rowKey = this.props.rowKey;\r\n\r\n    // let dataList = data.concat(addedData);\r\n\r\n    let arr = treeToList(data).list;\r\n\r\n    let k = row[rowKey];\r\n    let i = arr.findIndex(d => d[rowKey] === k);\r\n\r\n    if (i > -1) {\r\n      let changedRow = {};\r\n\r\n      Object.keys(newValues).forEach(k => {\r\n        arr[i][k] = newValues[k];\r\n        changedRow = Object.assign({}, arr[i]);\r\n        changedRow[k] = newValues[k];\r\n        //row[k] = newValues[k];\r\n      });\r\n\r\n      //this.setState({});\r\n\r\n      this.addToChanged(arr[i]);\r\n    }\r\n\r\n    let j = addedData.findIndex(d => d[rowKey] === k);\r\n\r\n    if (j > -1) {\r\n      Object.keys(newValues).forEach(k => {\r\n        addedData[j][k] = newValues[k];\r\n      });\r\n\r\n      this.addToChanged(addedData[j]);\r\n    }\r\n  };\r\n\r\n  setRowAttr = (row, attr = {}) => {\r\n    let rowKey = this.props.rowKey;\r\n    let key = row[rowKey];\r\n\r\n    let attrs = this.rowsAttributes || [];\r\n\r\n    let i = attrs.findIndex(d => d[rowKey] === key);\r\n\r\n    if (i > -1) {\r\n      let fRow = attrs[i];\r\n\r\n      if (typeof fRow.__attribute === \"undefined\") {\r\n        fRow.__attribute = attr;\r\n      } else {\r\n        fRow.__attribute = merge({}, fRow.__attribute, attr);\r\n      }\r\n    } else {\r\n      let newAttr = Object.assign({}, row);\r\n      newAttr.__attribute = attr;\r\n      attrs.push(newAttr);\r\n    }\r\n\r\n    this.rowsAttributes = attrs;\r\n  };\r\n\r\n  getRowAttr = row => {\r\n    let rowKey = this.props.rowKey;\r\n    let key = row[rowKey];\r\n\r\n    let attrs = this.rowsAttributes || [];\r\n    let attr = {};\r\n\r\n    let i = attrs.findIndex(d => d[rowKey] === key);\r\n    if (i > -1) {\r\n      attr = attrs[i] || {};\r\n    }\r\n\r\n    return Object.assign({}, attr.__attribute || {});\r\n  };\r\n\r\n  getValidate = (row, key) => {\r\n    let attr = this.getRowAttr(row);\r\n    let r = (attr[\"validation\"] || {})[key] || {};\r\n\r\n    return r;\r\n  };\r\n\r\n  //进行异步验证的promise\r\n  validatorAsync = [];\r\n\r\n  validateRow = row => {\r\n    let { columnList: columns } = this.state;\r\n\r\n    let bl = true;\r\n\r\n    let validation = {};\r\n\r\n    for (let i = 0; i < columns.length; i++) {\r\n      const c = columns[i];\r\n      const ck = c.dataIndex;\r\n\r\n      if (typeof c.validator === \"function\") {\r\n        var v = c.validator(row[ck], row);\r\n\r\n        if (v.constructor.name === \"Promise\") {\r\n          this.validatorAsync.push(\r\n            new Promise((resolve, reject) => {\r\n              v.then(d => {\r\n                resolve({ validation: d, row, columnKey: ck });\r\n              });\r\n\r\n              v.catch(e => {\r\n                reject(e);\r\n              });\r\n            })\r\n          );\r\n        } else {\r\n          validation[ck] = {\r\n            valid: v.valid,\r\n            msg: v.valid ? \"\" : v.message || \"输入不正确\"\r\n          };\r\n\r\n          if (!v.valid) bl = false;\r\n\r\n          this.setRowAttr(row, {\r\n            validation\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    return bl;\r\n  };\r\n\r\n  //异步验证数据行\r\n  validateAsync = rows => {\r\n    let arr = rows || [];\r\n\r\n    return new Promise((resolve, reject) => {\r\n      let bl = true;\r\n\r\n      for (let i = 0; i < arr.length; i++) {\r\n        const r = arr[i];\r\n        let temp = this.validateRow(r);\r\n        if (temp === false) {\r\n          bl = false;\r\n        }\r\n      }\r\n\r\n      if (this.validatorAsync.length > 0) {\r\n        Promise.all(this.validatorAsync).then(datas => {\r\n          datas.forEach(d => {\r\n            let v = d.validation;\r\n\r\n            if (v.valid === false) {\r\n              bl = false;\r\n            }\r\n\r\n            let validation = {};\r\n\r\n            validation[d.columnKey] = {\r\n              valid: v.valid,\r\n              msg: v.valid ? \"\" : v.message\r\n            };\r\n\r\n            this.setRowAttr(d.row, {\r\n              validation\r\n            });\r\n          });\r\n\r\n          this.validatorAsync = [];\r\n          this.updateComponent();\r\n\r\n          resolve(bl);\r\n        });\r\n      } else {\r\n        if (arr.length > 0) {\r\n          this.updateComponent();\r\n        }\r\n\r\n        resolve(bl);\r\n      }\r\n    });\r\n  };\r\n\r\n  //验证改变的数据行\r\n  validate = async () => {\r\n    let bl = true;\r\n    let arr = this.changedRows;\r\n\r\n    // let { data, addedData } = this.state;\r\n\r\n    // let arr = data.concat(addedData);\r\n\r\n    bl = await this.validateAsync(arr);\r\n\r\n    return bl;\r\n  };\r\n\r\n  //验证当前所有数据行\r\n  validateAll = async () => {\r\n    let bl = true;\r\n    let { data, addedData, editKeys, isEditAll } = this.state;\r\n    let rowKey = this.props.rowKey;\r\n\r\n    let allData = data.concat(addedData);\r\n\r\n    let arr = [];\r\n\r\n    if (isEditAll === true) {\r\n      arr = allData;\r\n    } else {\r\n      arr = allData.filter(d => {\r\n        return editKeys.indexOf(d[rowKey]) > -1;\r\n      });\r\n    }\r\n\r\n    bl = await this.validateAsync(arr);\r\n    // this.forceUpdate();\r\n    return bl;\r\n  };\r\n\r\n  editorInstance = [];\r\n  setEditorIns = (row, column, ins) => {\r\n    if (ins === null) {\r\n      return;\r\n    }\r\n\r\n    let rowKey = row[this.props.rowKey];\r\n    let columnKey = column.dataIndex;\r\n\r\n    let editorInstance = [].concat(this.editorInstance);\r\n\r\n    let ed = this.editorInstance.find(\r\n      d => d.rowKey === rowKey && d.columnKey === columnKey\r\n    );\r\n\r\n    if (ed) {\r\n      ed.editorInstance = ins;\r\n    } else {\r\n      editorInstance.push({\r\n        columnKey: columnKey,\r\n        rowKey: rowKey,\r\n        editorInstance: ins\r\n      });\r\n    }\r\n\r\n    this.editorInstance = editorInstance;\r\n  };\r\n\r\n  getEditorIns = (rowKey, columnKey) => {\r\n    let ed = this.editorInstance.find(\r\n      d => d.rowKey === rowKey && d.columnKey === columnKey\r\n    );\r\n\r\n    if (ed) {\r\n      return ed.editorInstance;\r\n    }\r\n    return null;\r\n  };\r\n\r\n  formatColumns = () => {\r\n    let { columns, editKeys, isEditAll, isEditing } = this.state;\r\n\r\n    let rowKey = this.props.rowKey;\r\n\r\n    let arr = columns;\r\n\r\n    arr = treeFilter(columns, d => {\r\n      let bl = true;\r\n\r\n      if (isEditing === true) {\r\n        bl = d.editingVisible !== false;\r\n      }\r\n\r\n      return bl;\r\n    });\r\n\r\n    let cols = treeToList(arr).leafs;\r\n\r\n    if (isEditAll === true) {\r\n      cols.forEach(d => {\r\n        let editor = d.editor;\r\n\r\n        if (typeof editor === \"function\") {\r\n          let renderFn = d.render;\r\n\r\n          d.render = (value, row, index) => {\r\n            let renderProps = null;\r\n            let newRenderProps = {};\r\n\r\n            if (typeof renderFn === \"function\") {\r\n              renderProps = renderFn(value, row, index);\r\n            }\r\n\r\n            if (\r\n              renderProps &&\r\n              renderProps.props &&\r\n              renderProps.props.colSpan === 0\r\n            ) {\r\n              return renderProps;\r\n            }\r\n\r\n            let { valid, msg } = this.getValidate(row, d.dataIndex) || {};\r\n\r\n            let ed = editor(\r\n              value,\r\n              row,\r\n              index,\r\n              values => {\r\n                this.editChange(values, row, index);\r\n              },\r\n              ins => {\r\n                this.setEditorIns(row, d, ins);\r\n              },\r\n              this.validate\r\n            );\r\n\r\n            let c = (\r\n              <span\r\n                style={{ verticalAlign: \"middle\" }}\r\n                className={valid === false ? \"has-error\" : \"\"}\r\n                onClick={e => this.onClick(e, row, d)}\r\n                onKeyDown={e => this.onKeyDown(e, row, d)}\r\n              >\r\n                <Tooltip placement=\"topLeft\" title={msg}>\r\n                  {ed}\r\n                </Tooltip>\r\n              </span>\r\n            );\r\n\r\n            newRenderProps.children = c;\r\n\r\n            if (renderProps && renderProps.props) {\r\n              newRenderProps.props = renderProps.props;\r\n            }\r\n\r\n            return c;\r\n          };\r\n        }\r\n      });\r\n    } else if (editKeys.length > 0) {\r\n      cols.forEach(d => {\r\n        if (typeof d.editingVisible === \"boolean\") {\r\n          d.hidden = !d.editingVisible;\r\n        }\r\n\r\n        let editor = d.editor;\r\n\r\n        if (typeof editor === \"function\") {\r\n          let renderFn = d.render;\r\n\r\n          d.render = (value, row, index) => {\r\n            let renderProps = null;\r\n            let newRenderProps = {};\r\n\r\n            if (typeof renderFn === \"function\") {\r\n              renderProps = renderFn(value, row, index);\r\n            }\r\n\r\n            if (\r\n              renderProps &&\r\n              renderProps.props &&\r\n              renderProps.props.colSpan === 0\r\n            ) {\r\n              return renderProps;\r\n            }\r\n\r\n            let bl = editKeys.findIndex(k => k === row[rowKey]) > -1;\r\n\r\n            if (bl) {\r\n              let { valid, msg } = this.getValidate(row, d.dataIndex) || {};\r\n\r\n              let ed = editor(\r\n                value,\r\n                row,\r\n                index,\r\n                values => {\r\n                  this.editChange(values, row, index);\r\n                },\r\n                ins => {\r\n                  this.setEditorIns(row, d, ins);\r\n                }\r\n              );\r\n\r\n              let c = (\r\n                <span\r\n                  style={{ verticalAlign: \"middle\" }}\r\n                  className={valid === false ? \"has-error\" : \"\"}\r\n                  onClick={e => this.onClick(e, row, d)}\r\n                  onKeyDown={e => this.onKeyDown(e, row, d)}\r\n                >\r\n                  <Tooltip placement=\"topLeft\" title={msg}>\r\n                    {ed}\r\n                  </Tooltip>\r\n                </span>\r\n              );\r\n\r\n              newRenderProps.children = c;\r\n\r\n              if (renderProps && renderProps.props) {\r\n                newRenderProps.props = renderProps.props;\r\n              }\r\n\r\n              return c;\r\n            } else {\r\n              if (typeof renderFn === \"function\") {\r\n                return renderFn(value, row, index);\r\n              }\r\n              return value;\r\n            }\r\n          };\r\n        }\r\n      });\r\n    }\r\n\r\n    arr = orderBy(arr, [\"order\"], [\"asc\"]);\r\n\r\n    return cloneDeep(arr);\r\n  };\r\n\r\n  editAll = () => {\r\n    this.setState({ isEditAll: true, isEditing: true, editKeys: [] });\r\n  };\r\n\r\n  endEdit = callBack => {\r\n    let arr = [].concat(this.changedRows);\r\n\r\n    this.changedRows = [];\r\n\r\n    let nextState = {\r\n      editSaveLoading: false,\r\n      isEditAll: false,\r\n      isAdding: false,\r\n      isAddingRange: false,\r\n      isEditing: false,\r\n      editKeys: [],\r\n      changedRows: [],\r\n      addedData: [],\r\n      sourceData: cloneDeep(this.state.data)\r\n    };\r\n\r\n    if (typeof callBack === \"function\") {\r\n      this.setState(nextState, () => {\r\n        callBack(arr, this.state.data, this.editType);\r\n      });\r\n    } else {\r\n      this.setState(nextState);\r\n    }\r\n  };\r\n\r\n  //取消编辑\r\n  cancelEdit = () => {\r\n    if (typeof this.props.onCancel === \"function\") {\r\n      this.props.onCancel();\r\n    }\r\n\r\n    this.reset();\r\n  };\r\n\r\n  editRows = keys => {\r\n    this.setState({ isEditAll: false, editKeys: keys, isEditing: true });\r\n  };\r\n\r\n  getChangedRows = () => {\r\n    return this.changedRows;\r\n  };\r\n\r\n  getRows = () => {\r\n    return this.state.data;\r\n  };\r\n\r\n  addRow = (r = {}, editting = true) => {\r\n    this.addRows([r], editting);\r\n  };\r\n\r\n  addRows = (arr = [], editting = true) => {\r\n    let rowKey = this.props.rowKey;\r\n    let { addedData, editKeys } = this.state;\r\n\r\n    let rowKeys = [];\r\n    let newEditKeys = [];\r\n    let newAddedData = [];\r\n\r\n    this.editType = \"add\";\r\n\r\n    let rows = [];\r\n\r\n    let rowTemplate = {};\r\n\r\n    arr.forEach((d, i) => {\r\n      let k = d[rowKey];\r\n\r\n      if (!k) {\r\n        k = d[rowKey] = \"__id_\" + i + \"_\" + new Date().getTime();\r\n      }\r\n\r\n      rows.push(Object.assign({}, rowTemplate, d));\r\n      rowKeys.push(k);\r\n    });\r\n\r\n    newEditKeys = editKeys.concat(rowKeys);\r\n    newAddedData = [].concat(rows);\r\n\r\n    if (editting === false) {\r\n      this.setState({\r\n        isAddingRange: true,\r\n        addedData: newAddedData\r\n      });\r\n    } else {\r\n      this.setState({\r\n        isAddingRange: true,\r\n        isEditing: true,\r\n        addedData: newAddedData,\r\n        editKeys: newEditKeys\r\n      });\r\n    }\r\n  };\r\n\r\n  setRows = (arr = []) => {\r\n    this.changedRows = [];\r\n    this.setState({\r\n      data: arr,\r\n      editKeys: [],\r\n      isEditAll: false,\r\n      changedRows: []\r\n    });\r\n  };\r\n\r\n  reset = () => {\r\n    let data = cloneDeep(this.state.sourceData);\r\n\r\n    let nextState = {\r\n      isEditAll: false,\r\n      isAdding: false,\r\n      isAddingRange: false,\r\n      isEditing: false,\r\n      editKeys: [],\r\n      data: data,\r\n      changedRows: [],\r\n      addedData: []\r\n    };\r\n\r\n    this.changedRows = [];\r\n    this.setState(nextState);\r\n  };\r\n\r\n  focusInput = editor => {\r\n    if (!editor) {\r\n      return;\r\n    }\r\n\r\n    if (editor.input && typeof editor.input.select === \"function\") {\r\n      setTimeout(() => {\r\n        editor.input.select();\r\n      }, 1);\r\n    } else if (typeof editor.focus === \"function\") {\r\n      editor.focus();\r\n    } else {\r\n      let el = ReactDom.findDOMNode(editor);\r\n\r\n      if (el) {\r\n        let inputEl = el.getElementsByTagName(\"input\")[0];\r\n        inputEl && inputEl.focus();\r\n        el.focus();\r\n      }\r\n    }\r\n  };\r\n\r\n  getNextEditor = (keyCode, row, column) => {\r\n    let nextEditor = null;\r\n\r\n    let key = this.props.rowKey;\r\n\r\n    let rowKey = row[key];\r\n\r\n    let columnKey = column.dataIndex;\r\n\r\n    let { data, addedData, columns } = this.state;\r\n\r\n    let rows = [].concat(data).concat(addedData);\r\n\r\n    let arr = treeToList(columns).leafs;\r\n\r\n    if (keyCode === 38) {\r\n      //top\r\n\r\n      let currIndex = rows.findIndex(d => d[key] === rowKey);\r\n      let nextRow = rows[currIndex - 1];\r\n\r\n      if (nextRow) {\r\n        nextEditor = this.getEditorIns(nextRow[key], columnKey);\r\n      }\r\n    }\r\n\r\n    if (keyCode === 40) {\r\n      //bottom\r\n\r\n      let currIndex = rows.findIndex(d => d[key] === rowKey);\r\n      let nextRow = rows[currIndex + 1];\r\n\r\n      if (nextRow) {\r\n        nextEditor = this.getEditorIns(nextRow[key], columnKey);\r\n      }\r\n    }\r\n\r\n    if (keyCode === 37) {\r\n      //left\r\n\r\n      let currColumnIndex = arr.findIndex(d => d[\"dataIndex\"] === columnKey);\r\n      let nextColumn = arr[currColumnIndex - 1];\r\n\r\n      if (nextColumn) {\r\n        nextEditor = this.getEditorIns(rowKey, nextColumn[\"dataIndex\"]);\r\n      }\r\n    }\r\n\r\n    if (keyCode === 39 || keyCode === 13) {\r\n      //right\r\n\r\n      let currColumnIndex = arr.findIndex(d => d[\"dataIndex\"] === columnKey);\r\n      let nextColumn = arr[currColumnIndex + 1];\r\n\r\n      if (nextColumn) {\r\n        nextEditor = this.getEditorIns(rowKey, nextColumn[\"dataIndex\"]);\r\n      }\r\n    }\r\n\r\n    return nextEditor;\r\n  };\r\n\r\n  onKeyDown = (e, row, column) => {\r\n    // e.preventDefault();\r\n    //e.stopPropagation();\r\n\r\n    let key = this.props.rowKey;\r\n\r\n    let rowKey = row[key];\r\n    let columnKey = column.dataIndex;\r\n\r\n    let nextEditor = this.getNextEditor(e.keyCode, row, column);\r\n\r\n    let currEditor = this.getEditorIns(rowKey, columnKey);\r\n\r\n    if (currEditor) {\r\n      //ly 2018年11月6日 11点12分\r\n      //当当前编辑器为下拉类型时，如 datePicker comobobox 。获取展开状态，展开时禁用表格列的快捷键切换\r\n      if (typeof currEditor.getRealOpenState === \"function\") {\r\n        let bl = currEditor.getRealOpenState();\r\n\r\n        if (e.keyCode === 13) {\r\n          this.focusInput(nextEditor);\r\n          return false;\r\n        }\r\n\r\n        if (bl === true) {\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.focusInput(nextEditor);\r\n  };\r\n\r\n  onClick = (e, row, column) => {\r\n    this.isMouseFocus = true;\r\n    e.stopPropagation();\r\n  };\r\n\r\n  completeEdit = async callBack => {\r\n    let changedRows = this.getChangedRows();\r\n\r\n    let editType = this.editType;\r\n    let { data, addedData } = this.state;\r\n    let { allowSaveEmpty, alwaysValidate } = this.props;\r\n\r\n    let newRows = [].concat(data);\r\n    if (editType === \"add\") {\r\n      if (allowSaveEmpty === true) {\r\n        let addedRows = addedData.map(d => {\r\n          let r = Object.assign({}, d);\r\n          delete r.__isAddedRow;\r\n          return r;\r\n        });\r\n        newRows = data.concat(addedRows);\r\n      } else {\r\n        newRows = data.concat(changedRows);\r\n      }\r\n    } else if (editType === \"edit\") {\r\n      newRows = data;\r\n    } else if (editType === \"delete\") {\r\n      newRows = data;\r\n    }\r\n\r\n    let bl = true;\r\n\r\n    if (alwaysValidate === true) {\r\n      bl = await this.validateAll();\r\n    } else {\r\n      bl = await this.validate();\r\n    }\r\n\r\n    if (bl === false) {\r\n      message.error(\"信息录入不正确，请检查\");\r\n      return;\r\n    }\r\n\r\n    if (allowSaveEmpty !== true) {\r\n      if (changedRows.length <= 0) {\r\n        this.cancelEdit();\r\n        return;\r\n      }\r\n    }\r\n\r\n    let onEditSave = this.props.onEditSave;\r\n\r\n    if (typeof onEditSave === \"function\") {\r\n      this.setState({ editSaveLoading: true });\r\n\r\n      let fn = onEditSave(changedRows, newRows, this.editType);\r\n\r\n      if (fn) {\r\n        //如果返回的是一个promise对象，则只有当调用resolve时，才触发编辑完成事件\r\n        if (typeof fn.then === \"function\" && typeof fn.catch === \"function\") {\r\n          fn.then(() => {\r\n            this.endEdit(callBack);\r\n          });\r\n\r\n          fn.catch(() => {\r\n            this.setState({ editSaveLoading: false });\r\n          });\r\n        } else {\r\n          this.setState({ editSaveLoading: false });\r\n        }\r\n      } else {\r\n        this.endEdit(callBack);\r\n      }\r\n    } else {\r\n      this.endEdit(callBack);\r\n    }\r\n  };\r\n\r\n  //\"edit\"：编辑 ； \"add\"：新增 \"delete\"： 删除\r\n  editType = \"\";\r\n  edit = () => {\r\n    let arr = this.state.data || [];\r\n\r\n    if (arr.length === 0) {\r\n      message.error(\"没有可编辑的数据\");\r\n      return false;\r\n    }\r\n\r\n    let bl = true;\r\n\r\n    if (typeof this.props.onBeforeEdit === \"function\") {\r\n      bl = this.props.onBeforeEdit();\r\n    }\r\n\r\n    if (bl === false) {\r\n      return false;\r\n    }\r\n\r\n    this.editType = \"edit\";\r\n\r\n    this.editAll();\r\n\r\n    if (typeof this.props.onEdit === \"function\") {\r\n      this.props.onEdit();\r\n    }\r\n  };\r\n\r\n  delete = () => {\r\n    let bl = true;\r\n\r\n    let selectedKeys = this.selectedRowKeys;\r\n\r\n    if (typeof this.props.onBeforeDelete === \"function\") {\r\n      bl = this.props.onBeforeDelete(selectedKeys);\r\n    }\r\n\r\n    if (bl === false) {\r\n      return false;\r\n    }\r\n\r\n    if (selectedKeys.length <= 0) {\r\n      message.warn(\"请选择要删除的数据\");\r\n    } else {\r\n      this.editType = \"delete\";\r\n\r\n      let { data, rowKey } = this.state;\r\n\r\n      let newData = [].concat(data);\r\n      let deletedRows = [];\r\n\r\n      for (let i = 0; i < selectedKeys.length; i++) {\r\n        let index = newData.findIndex(d => d[rowKey] === selectedKeys[i]);\r\n\r\n        deletedRows.push(Object.assign({}, newData[index]));\r\n\r\n        if (index > -1) {\r\n          newData.splice(index, 1);\r\n        }\r\n      }\r\n\r\n      let onEditSave = this.props.onEditSave;\r\n\r\n      if (typeof onEditSave === \"function\") {\r\n        this.setState({ deleteLoading: true });\r\n\r\n        let fn = onEditSave(deletedRows, newData, this.editType);\r\n\r\n        if (fn && typeof fn.then === \"function\") {\r\n          fn.then(() => {\r\n            this.setState({ deleteLoading: false });\r\n          });\r\n        } else {\r\n          this.setState({ deleteLoading: false });\r\n        }\r\n      } else {\r\n        this.setState({ data: newData, deletedRows });\r\n      }\r\n\r\n      if (typeof this.props.onDelete === \"function\") {\r\n        this.props.onDelete();\r\n      }\r\n    }\r\n  };\r\n\r\n  addRange = rowCount => {\r\n    let { rowTemplate, rowKey, isAppend, defaultAddCount } = this.props;\r\n\r\n    let bl = true;\r\n\r\n    if (typeof this.props.onBeforeAdd === \"function\") {\r\n      bl = this.props.onBeforeAdd();\r\n    }\r\n\r\n    if (bl === false) {\r\n      return false;\r\n    }\r\n\r\n    this.editType = \"add\";\r\n\r\n    let addCount = rowCount || defaultAddCount;\r\n\r\n    let data = this.state.data || [];\r\n\r\n    let newData = [];\r\n\r\n    let addedData = [];\r\n    let keys = [];\r\n\r\n    for (let i = 0; i < addCount; i++) {\r\n      let row = {};\r\n\r\n      if (typeof rowTemplate === \"function\") {\r\n        row = rowTemplate(i);\r\n        if (!row[rowKey]) {\r\n          row[rowKey] = \"__id_\" + i + \"_\" + new Date().getTime();\r\n        }\r\n      } else {\r\n        row[rowKey] = \"__id_\" + i + \"_\" + new Date().getTime();\r\n      }\r\n\r\n      keys.push(row[rowKey]);\r\n      addedData.push(row);\r\n    }\r\n\r\n    // if (isAppend === true) {\r\n    //     newData = data.concat(addedData)\r\n    // } else {\r\n    //     newData = addedData;\r\n    // }\r\n\r\n    this.changedRows = [];\r\n\r\n    this.setState({\r\n      addedData,\r\n      data: data,\r\n      editKeys: keys,\r\n      isEditing: true,\r\n      isEditAll: false,\r\n      isAdding: false,\r\n      isAddingRange: true,\r\n      changedRows: []\r\n    });\r\n\r\n    if (typeof this.props.onAdd === \"function\") {\r\n      this.props.onAdd(addedData, newData, \"add\");\r\n    }\r\n  };\r\n\r\n  editTools = () => {\r\n    let w = 0;\r\n\r\n    let tools = this.props.editTools || [];\r\n    let config = this.props.editToolsConfig || {};\r\n    let isTop = config.position === \"top\";\r\n\r\n    if (tools.length <= 0) {\r\n      return null;\r\n    }\r\n\r\n    let buttons = [];\r\n\r\n    let { isEditing } = this.state;\r\n\r\n    let itemStyle = config.itemStyle || { marginRight: 5 };\r\n\r\n    let okText = config.okText || \"确定\";\r\n    let okIcon = config.okIcon || \"\";\r\n    okIcon = okIcon ? <Icon type={okIcon} /> : null;\r\n\r\n    let cancelText = config.cancelText || \"取消\";\r\n    let cancelIcon = config.cancelIcon || \"\";\r\n    cancelIcon = cancelIcon ? <Icon type={cancelIcon} /> : null;\r\n\r\n    let addText = config.addText || \"新增\";\r\n    let addIcon = config.addIcon || \"\";\r\n    addIcon = addIcon ? <Icon type={addIcon} /> : null;\r\n\r\n    let editText = config.editText || \"编辑\";\r\n    let editIcon = config.editIcon || \"\";\r\n    editIcon = editIcon ? <Icon type={editIcon} /> : null;\r\n\r\n    let deleteText = config.deleteText || \"删除\";\r\n    let deleteIcon = config.deleteIcon || \"\";\r\n    deleteIcon = deleteIcon ? <Icon type={deleteIcon} /> : null;\r\n\r\n    if (isEditing) {\r\n      w = 160;\r\n      buttons.push(\r\n        <Button\r\n          key={\"_btnOk\"}\r\n          loading={this.state.editSaveLoading}\r\n          onClick={this.completeEdit}\r\n          style={{ ...itemStyle }}\r\n        >\r\n          {okIcon}\r\n          {okText}\r\n        </Button>\r\n      );\r\n      buttons.push(\r\n        <Button key={\"_btnCancel\"} onClick={this.cancelEdit} style={itemStyle}>\r\n          {cancelIcon}\r\n          {cancelText}\r\n        </Button>\r\n      );\r\n    } else {\r\n      tools.forEach((d, i) => {\r\n        w += 80;\r\n\r\n        let styles = { ...itemStyle };\r\n\r\n        const menu = (\r\n          <Menu onClick={e => this.addRange(e.item.props.value)}>\r\n            <Menu.Item key=\"1\" value={5}>\r\n              5 行\r\n            </Menu.Item>\r\n            <Menu.Item key=\"2\" value={10}>\r\n              10 行\r\n            </Menu.Item>\r\n          </Menu>\r\n        );\r\n\r\n        if (d === \"addSingle\") {\r\n          buttons.push(\r\n            <Button\r\n              key={d + \"_1\"}\r\n              onClick={() => this.addRange(1)}\r\n              style={styles}\r\n            >\r\n              {addIcon}\r\n              {addText}\r\n            </Button>\r\n          );\r\n        }\r\n\r\n        if (d === \"add\") {\r\n          buttons.push(\r\n            <Dropdown key={d + \"_1\"} overlay={menu}>\r\n              <Button tool=\"add\" style={styles} onClick={() => this.addRange()}>\r\n                {addIcon} {addText}\r\n                <Icon type=\"down\" />\r\n              </Button>\r\n            </Dropdown>\r\n          );\r\n        }\r\n\r\n        if (d === \"edit\") {\r\n          buttons.push(\r\n            <Button key={d + \"_1\"} onClick={this.edit} style={styles}>\r\n              {editIcon}\r\n              {editText}\r\n            </Button>\r\n          );\r\n        }\r\n\r\n        if (d === \"delete\") {\r\n          buttons.push(\r\n            <Popconfirm\r\n              key={d}\r\n              title=\"确定删除选中的数据吗？\"\r\n              okText=\"确定\"\r\n              cancelText=\"取消\"\r\n              onConfirm={this.delete}\r\n            >\r\n              <Button\r\n                style={styles}\r\n                loading={this.state.deleteLoading}\r\n                onClick={e => {\r\n                  e.stopPropagation();\r\n                }}\r\n              >\r\n                {deleteIcon}\r\n                {deleteText}\r\n              </Button>\r\n            </Popconfirm>\r\n          );\r\n        }\r\n\r\n        if (typeof d === \"function\") {\r\n          buttons.push(\r\n            <span style={styles} key={\"_fnTools_\" + i}>\r\n              {d()}\r\n            </span>\r\n          );\r\n        }\r\n\r\n        if (typeof d === \"object\" && d !== null) {\r\n          let toolIcon = d.icon;\r\n          toolIcon = toolIcon ? <Icon type={toolIcon} /> : null;\r\n          let toolAttr = d.props || {};\r\n          buttons.push(\r\n            <Button\r\n              key={\"_objTools_\" + i}\r\n              onClick={d.handler}\r\n              style={styles}\r\n              {...toolAttr}\r\n            >\r\n              {toolIcon}\r\n              {d.text}\r\n            </Button>\r\n          );\r\n        }\r\n      });\r\n    }\r\n\r\n    if (buttons.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    return <div>{buttons}</div>;\r\n  };\r\n\r\n  getProps = () => {\r\n    let props = this.props || {};\r\n    let newProps = Object.assign({}, props);\r\n\r\n    return newProps;\r\n  };\r\n\r\n  createToolBar = () => {\r\n    if (this.props.editable === true) {\r\n      let tools = this.editTools();\r\n\r\n      if (tools !== null) {\r\n        return (\r\n          <div\r\n            style={{\r\n              backgroundColor: \"#ffffff\",\r\n              marginRight: 5\r\n            }}\r\n          >\r\n            {tools}\r\n          </div>\r\n        );\r\n      } else {\r\n        return null;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  getDataRows = () => {\r\n    let { data, addedData, isAdding, isAddingRange, dataList } = this.state;\r\n\r\n    let arr = data;\r\n\r\n    let { isAppend, rowKey } = this.props;\r\n\r\n    let addedRows = [];\r\n\r\n    addedData.forEach(d => {\r\n      if (dataList.findIndex(c => c[rowKey] === d[rowKey]) <= -1) {\r\n        let r = d;\r\n        r.__isAddedRow = true;\r\n        addedRows.push(r);\r\n      }\r\n    });\r\n\r\n    if (isAdding === true || isAddingRange === true) {\r\n      if (isAppend === true) {\r\n        arr = [].concat(data).concat(addedRows);\r\n      } else {\r\n        arr = addedRows;\r\n      }\r\n    }\r\n\r\n    return arr;\r\n  };\r\n\r\n  updateRows = callback => {\r\n    let arr = [];\r\n\r\n    if (typeof callback === \"function\") {\r\n      let currData = this.getDataRows();\r\n\r\n      arr = callback(currData);\r\n\r\n      if (arr.length > 0) {\r\n        this.setState({\r\n          data: this.state.data\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  api = {\r\n    editAll: this.editAll,\r\n    addRange: this.addRange,\r\n    delete: this.delete,\r\n    reset: this.reset,\r\n    completeEdit: this.completeEdit,\r\n    cancelEdit: this.cancelEdit,\r\n    isEditing: this.isEditing,\r\n    getData: () => this.state.data\r\n  };\r\n\r\n  headerExtra = () => {\r\n    let header = null;\r\n\r\n    let { editToolsConfig = {} } = this.props;\r\n    let toolBarPosition = editToolsConfig.position;\r\n\r\n    if (toolBarPosition === \"top\") {\r\n      header = this.createToolBar();\r\n    }\r\n\r\n    return header;\r\n  };\r\n\r\n  footerExtra = () => {\r\n    let { editToolsConfig = {} } = this.props;\r\n    let toolBarPosition = editToolsConfig.position;\r\n\r\n    let toolBar = null;\r\n\r\n    if (toolBarPosition === \"bottom\") {\r\n      toolBar = this.createToolBar();\r\n    }\r\n\r\n    return toolBar;\r\n  };\r\n\r\n  selectedRowKeys = [];\r\n  onSelectChange = selectedKeys => {\r\n    this.selectedRowKeys = selectedKeys;\r\n  };\r\n\r\n  render() {\r\n    let columns = this.formatColumns();\r\n\r\n    let arr = this.getDataRows();\r\n\r\n    let props = this.props;\r\n\r\n    let newProps = {\r\n      editable: true,\r\n      data: arr,\r\n      columns,\r\n      onSelectChange: this.onSelectChange,\r\n      initRef: this.initRef,\r\n      header: this.headerExtra,\r\n      footer: this.footerExtra\r\n    };\r\n\r\n    return <Table {...props} {...newProps} />;\r\n  }\r\n}\r\n\r\nexport default EditableTable;\r\n","import React from \"react\";\r\nimport FeaturedTable from \"./Editable\";\r\nimport PropTypes from \"prop-types\";\r\nimport \"./styles.css\";\r\n\r\nconst Table = React.forwardRef((props, ref) => (\r\n  <FeaturedTable {...props} ref={ref} />\r\n));\r\n\r\nTable.defaultProps = {\r\n  editable: false,\r\n  editTools: [\"edit\", \"add\"],\r\n  editToolsConfig: {\r\n    position: \"bottom\",\r\n    itemStyle: { marginLeft: \"5px\" },\r\n    editText: \"\",\r\n    editIcon: \"\",\r\n    addText: \"\",\r\n    addIcon: \"\",\r\n    deleteText: \"\",\r\n    deleteIcon: \"\",\r\n    okText: \"\",\r\n    okIcon: \"\",\r\n    cancelText: \"\",\r\n    cancelIcon: \"\"\r\n  },\r\n  defaultAddCount: 1,\r\n  isAppend: false,\r\n  validateTrigger: \"onSave\",\r\n  validateDelay: 300,\r\n  allowSaveEmpty: false,\r\n  dataControled: false,\r\n  alwaysValidate: false\r\n};\r\n\r\nTable.propTypes = {\r\n  /** 是否允许编辑 */\r\n  editable: PropTypes.bool,\r\n  /** 工具栏，工具按钮 ['edit', 'add','delete',{icon:\"\",text:\"\",props:{},handler:Function},Function] addSingle:单行新增 */\r\n  editTools: PropTypes.array,\r\n  /** 工具栏，工具按钮属性配置{ position: \"bottom\", itemStyle: { marginRight: \"5px\" }, editText: \"\", editIcon: \"\", addText: \"\", addIcon: \"\", deleteText: \"\", deleteIcon: \"\", okText: \"\", okIcon: \"\", cancelText: \"\", cancelIcon: \"\" } */\r\n  editToolsConfig: PropTypes.object,\r\n  /** 新增行时，是追加，还是清空当前页数据 */\r\n  isAppend: PropTypes.bool,\r\n  /** 新增行时的默认条数 */\r\n  defaultAddCount: PropTypes.number,\r\n\r\n  /** 编辑确定事件 (changedRows,newRows,editType)=>void\r\n   * @param {Array} changedRows-改变的数据行\r\n   * @param {Array} newRows-改变后最新的数据\r\n   * @param {string} editType-编辑类型;\"edit\":编辑;\"add\":新增;\"delete\":删除\r\n   */\r\n  onEditSave: PropTypes.func,\r\n  /** 当没有改变行数据时，是否仍然执行onEditSave */\r\n  allowSaveEmpty: PropTypes.bool,\r\n  /** 验证时机 */\r\n  validateTrigger: PropTypes.oneOf([\"onChange\", \"onBlur\", \"onSave\"]),\r\n\r\n  /** 新增按钮前置事件，返回false不进入新增状态 ()=>bool */\r\n  onBeforeAdd: PropTypes.func,\r\n\r\n  /** 新增按钮事件 (addedData, newData)=>void\r\n   * @param {Array} addedData-添加的数据行\r\n   * @param {Array} newRows-添加后最新的数据\r\n   */\r\n  onAdd: PropTypes.func,\r\n\r\n  /** 新增时的行数据模板，可通过此项设置默认行数据 (rowIndex)=>object\r\n   * @param {numer} rowIndex\r\n   * @returns {object} 行对象\r\n   */\r\n  rowTemplate: PropTypes.func,\r\n\r\n  /** 编辑取消事件 */\r\n  onCancel: PropTypes.func,\r\n  /** 编辑按钮前置事件，返回false不进入编辑状态 */\r\n  onBeforeEdit: PropTypes.func,\r\n\r\n  /** 编辑按钮事件 */\r\n  onEdit: PropTypes.func,\r\n  /**\r\n   * 删除按钮前置事件,返回false 不可删除\r\n   */\r\n  onBeforeDelete: PropTypes.func,\r\n  /** 删除按钮事件 */\r\n  onDelete: PropTypes.func,\r\n  /** 无论是否存在输入变化，是否始终验证 */\r\n  alwaysValidate: PropTypes.bool,\r\n  /** 数据是否完全受控，如若受控，请在onEditSave、onCancel中自行更新数据源 */\r\n  dataControled: PropTypes.bool\r\n};\r\n\r\nexport default Table;\r\n","\r\nexport function flatten(arr) {\r\n    let treeList = arr || [];\r\n  \r\n    //末级节点\r\n    let leafs = [];\r\n    //根\r\n    let roots = [];\r\n  \r\n    //所有节点\r\n    let list = [];\r\n  \r\n    for (let i = 0; i < treeList.length; i++) {\r\n      const d = treeList[i];\r\n  \r\n      if (!d) {\r\n        continue;\r\n      }\r\n      const childrens = d.children || [];\r\n  \r\n      list.push(d);\r\n      roots.push(d);\r\n  \r\n      if (childrens.length > 0) {\r\n        getChildren(d, 0);\r\n      } else {\r\n        leafs.push(d);\r\n      }\r\n    }\r\n  \r\n    function getChildren(item, depth) {\r\n      const tempArr = item.children || [];\r\n  \r\n      for (let i = 0; i < tempArr.length; i++) {\r\n        const d = tempArr[i];\r\n        const childrens = d.children || [];\r\n  \r\n        list.push(d);\r\n  \r\n        if (childrens.length > 0) {\r\n          getChildren(d, depth + 1);\r\n        } else {\r\n          leafs.push(d);\r\n        }\r\n      }\r\n    }\r\n  \r\n    return { list, leafs, roots };\r\n  }\r\n  \r\n  \r\n  export function unflatten(arr = [], idField, pidField) {\r\n  \r\n    let tree = [];\r\n  \r\n    function getChildren(item) {\r\n  \r\n        let id = item[idField];\r\n  \r\n        let childrens = arr.filter(y => y[pidField] === id);\r\n  \r\n        for (let i = 0; i < childrens.length; i++) {\r\n  \r\n            let d = childrens[i];\r\n            const nextId = d[idField];\r\n  \r\n            const nextChildrens = arr.filter(y => y[pidField] === nextId);\r\n  \r\n            if (nextChildrens.length > 0) {\r\n                d.children = getChildren(d);\r\n            }\r\n  \r\n        }\r\n  \r\n        return childrens;\r\n  \r\n    }\r\n  \r\n    let roots = arr.filter(d => !d[pidField]);\r\n  \r\n  \r\n    for (let i = 0, len = roots.length; i < len; i++) {\r\n  \r\n        let d = Object.assign({}, roots[i]);\r\n  \r\n        d.children = getChildren(d);\r\n  \r\n        tree.push(d)\r\n    }\r\n  \r\n    return tree;\r\n  }\r\n  \r\n  ","import React from \"react\";\r\nimport Table from \"./featured\";\r\n\r\nexport { flatten, unflatten } from \"./utils\";\r\n\r\nexport { Table };\r\nexport default Table;\r\n"],"sourceRoot":""}