{"remainingRequest":"/home/nexx/develop/tablex/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/nexx/develop/tablex/node_modules/docz-core/node_modules/babel-loader/lib/index.js??ref--5-2!/home/nexx/develop/tablex/node_modules/source-map-loader/index.js!/home/nexx/develop/tablex/src/index.js","dependencies":[{"path":"/home/nexx/develop/tablex/src/index.js","mtime":1555836911803},{"path":"/home/nexx/develop/tablex/node_modules/cache-loader/dist/cjs.js","mtime":1555737869369},{"path":"/home/nexx/develop/tablex/node_modules/thread-loader/dist/cjs.js","mtime":1555737872026},{"path":"/home/nexx/develop/tablex/node_modules/docz-core/node_modules/babel-loader/lib/index.js","mtime":1555737864633},{"path":"/home/nexx/develop/tablex/node_modules/source-map-loader/index.js","mtime":1555737871137}],"contextDependencies":[],"result":["import _toConsumableArray from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/nexx/develop/tablex/src/index.js\";\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport TableBody from \"./components/body\";\nimport TableHead from \"./components/head\";\nimport \"./index.css\";\nimport { treeToList, getDataListWithExpanded } from \"./tree-data-utils\";\nimport LoadingMsg from \"./components/loading\";\n\nvar Table =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Table, _React$Component);\n\n  function Table() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Table);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Table)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      rowKey: undefined,\n      columns: [],\n      columnLeafs: [],\n      dataSource: [],\n      dataList: [],\n      expandedKeys: [],\n      loadingKeys: []\n    };\n\n    _this.onBodyScroll = function (_ref) {\n      var scrollLeft = _ref.scrollLeft;\n      var head = _this.refs[\"head\"];\n      head.scrollTo(scrollLeft, 0);\n    };\n\n    _this.onExpandChange = function (isExpand, key) {\n      isExpand === true ? _this.collapse(key) : _this.expand(key);\n    };\n\n    _this.expand = function (key) {\n      var expandedKeys = _this.state.expandedKeys;\n\n      var nextExpandedKeys = _toConsumableArray(expandedKeys);\n\n      var i = expandedKeys.indexOf(key);\n\n      if (i === -1) {\n        nextExpandedKeys.push(key);\n      }\n\n      _this.setState({\n        expandedKeys: nextExpandedKeys\n      });\n\n      if (typeof _this.props.loadChildrenData === \"function\") {\n        _this.loadChildrenData(key);\n      }\n    };\n\n    _this.collapse = function (key) {\n      var expandedKeys = _this.state.expandedKeys;\n\n      var nextExpandedKeys = _toConsumableArray(expandedKeys);\n\n      var i = expandedKeys.indexOf(key);\n\n      if (i > -1) {\n        nextExpandedKeys.splice(i, 1);\n      }\n\n      _this.setState({\n        expandedKeys: nextExpandedKeys\n      });\n    };\n\n    _this.setLoadingChildren = function (key, bl, callback) {\n      var loadingKeys = _this.state.loadingKeys;\n      var i = loadingKeys.indexOf(key);\n\n      var nextKeys = _toConsumableArray(loadingKeys);\n\n      if (bl === true) {\n        if (i === -1) {\n          nextKeys.push(key);\n        }\n      } else {\n        if (i > -1) {\n          nextKeys.splice(i, 1);\n        }\n      }\n\n      return _this.setState({\n        loadingKeys: nextKeys\n      }, callback);\n    };\n\n    _this.loadChildrenData = function (key) {\n      var _this$state = _this.state,\n          dataList = _this$state.dataList,\n          rowKey = _this$state.rowKey;\n      var row = dataList.find(function (d) {\n        return d[rowKey] === key;\n      });\n\n      var res = _this.props.loadChildrenData(row);\n\n      if (res && res.constructor.name === \"Promise\") {\n        _this.setLoadingChildren(key, true);\n\n        res.then(function (childrens) {\n          if (childrens) {\n            row.children = childrens;\n          }\n\n          _this.setLoadingChildren(key, false);\n        });\n        res.catch(function (e) {\n          _this.setLoadingChildren(key, false);\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(Table, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          columns = _this$state2.columns,\n          columnLeafs = _this$state2.columnLeafs,\n          dataList = _this$state2.dataList,\n          rowKey = _this$state2.rowKey,\n          expandedKeys = _this$state2.expandedKeys,\n          loadingKeys = _this$state2.loadingKeys,\n          loading = _this$state2.loading;\n      return React.createElement(\"div\", {\n        className: \"tablex\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"tablex-head\",\n        ref: \"head\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(TableHead, {\n        columns: columns,\n        columnLeafs: columnLeafs,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"tablex-body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(TableBody, {\n        rowKey: rowKey,\n        columns: columns,\n        columnLeafs: columnLeafs,\n        dataSource: dataList,\n        onScroll: this.onBodyScroll,\n        onExpandChange: this.onExpandChange,\n        expandedKeys: expandedKeys,\n        loadingKeys: loadingKeys,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }), loading === false ? React.createElement(LoadingMsg, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }) : null));\n    }\n  }, {\n    key: \"__reactstandin__regenerateByEval\",\n    // @ts-ignore\n    value: function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      var expandedKeys = prevState.expandedKeys;\n      var rowKey = nextProps.rowKey,\n          columns = nextProps.columns,\n          dataSource = nextProps.dataSource,\n          loading = nextProps.loading;\n\n      var _treeToList = treeToList(columns),\n          columnLeafs = _treeToList.leafs;\n\n      var dataList = dataSource;\n\n      if (expandedKeys.length > 0) {\n        dataList = getDataListWithExpanded(dataSource, expandedKeys, rowKey);\n      }\n\n      var nextState = {\n        rowKey: rowKey,\n        columns: columns,\n        dataSource: dataSource,\n        columnLeafs: columnLeafs,\n        dataList: dataList,\n        loading: !!loading\n      };\n      return nextState;\n    }\n    /**\n     * @isExpand 是否展开\n     * @key 受影响的行数据key\n     */\n\n  }]);\n\n  return Table;\n}(React.Component);\n\nTable.defaultProps = {\n  columns: [],\n  dataSource: [],\n  loading: false\n};\nTable.propTypes = {\n  /**\n   * 表格列\n   *\n   */\n  columns: PropTypes.array.isRequired,\n\n  /**\n   * 表格数据\n   */\n  dataSource: PropTypes.array.isRequired,\n\n  /** 数据行主键字段\n   * 主要用于行展开\n   */\n  rowKey: PropTypes.string.isRequired,\n\n  /** 行展开变化事件\n   * @expandedRows 展开的行\n   */\n  onExpandedRowsChange: PropTypes.func,\n  rowIndent: PropTypes.number,\n  expandedKeys: PropTypes.array,\n  loadChildrenData: PropTypes.func,\n  loading: PropTypes.bool\n};\nvar _default = Table;\nexport default _default;\n\nif (typeof Table !== 'undefined' && Table && Table === Object(Table) && Object.isExtensible(Table)) {\n  Object.defineProperty(Table, '__filemeta', {\n    enumerable: true,\n    configurable: true,\n    value: {\n      name: \"Table\",\n      filename: \"src/index.js\"\n    }\n  });\n}\n\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(Table, \"Table\", \"/home/nexx/develop/tablex/src/index.js\");\n  reactHotLoader.register(_default, \"default\", \"/home/nexx/develop/tablex/src/index.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();",{"version":3,"sources":["/home/nexx/develop/tablex/src/index.js"],"names":["React","PropTypes","TableBody","TableHead","treeToList","getDataListWithExpanded","LoadingMsg","Table","state","rowKey","undefined","columns","columnLeafs","dataSource","dataList","expandedKeys","loadingKeys","onBodyScroll","scrollLeft","head","refs","scrollTo","onExpandChange","isExpand","key","collapse","expand","nextExpandedKeys","i","indexOf","push","setState","props","loadChildrenData","splice","setLoadingChildren","bl","callback","nextKeys","row","find","d","res","constructor","name","then","childrens","children","catch","e","loading","nextProps","prevState","leafs","length","nextState","Component","defaultProps","propTypes","array","isRequired","string","onExpandedRowsChange","func","rowIndent","number","bool"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport TableBody from \"./components/body\";\nimport TableHead from \"./components/head\";\nimport \"./index.css\";\nimport { treeToList, getDataListWithExpanded } from \"./tree-data-utils\";\n\nimport LoadingMsg from \"./components/loading\";\n\nclass Table extends React.Component {\n  state = {\n    rowKey: undefined,\n    columns: [],\n    columnLeafs: [],\n    dataSource: [],\n    dataList: [],\n\n    expandedKeys: [],\n    loadingKeys: []\n  };\n\n  onBodyScroll = ({ scrollLeft }) => {\n    let head = this.refs[\"head\"];\n    head.scrollTo(scrollLeft, 0);\n  };\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    let { expandedKeys } = prevState;\n\n    let { rowKey, columns, dataSource, loading } = nextProps;\n\n    let { leafs: columnLeafs } = treeToList(columns);\n\n    let dataList = dataSource;\n\n    if (expandedKeys.length > 0) {\n      dataList = getDataListWithExpanded(dataSource, expandedKeys, rowKey);\n    }\n\n    let nextState = {\n      rowKey,\n      columns,\n      dataSource,\n      columnLeafs,\n      dataList,\n      loading: !!loading\n    };\n\n    return nextState;\n  }\n\n  /**\n   * @isExpand 是否展开\n   * @key 受影响的行数据key\n   */\n  onExpandChange = (isExpand, key) => {\n    isExpand === true ? this.collapse(key) : this.expand(key);\n  };\n\n  /**\n   * 展开\n   */\n  expand = key => {\n    let { expandedKeys } = this.state;\n\n    let nextExpandedKeys = [...expandedKeys];\n\n    let i = expandedKeys.indexOf(key);\n\n    if (i === -1) {\n      nextExpandedKeys.push(key);\n    }\n\n    this.setState({\n      expandedKeys: nextExpandedKeys\n    });\n\n    if (typeof this.props.loadChildrenData === \"function\") {\n      this.loadChildrenData(key);\n    }\n  };\n\n  /**\n   * 折叠\n   */\n  collapse = key => {\n    let { expandedKeys } = this.state;\n\n    let nextExpandedKeys = [...expandedKeys];\n\n    let i = expandedKeys.indexOf(key);\n\n    if (i > -1) {\n      nextExpandedKeys.splice(i, 1);\n    }\n\n    this.setState({\n      expandedKeys: nextExpandedKeys\n    });\n  };\n\n  /**\n   * 设置行的子级加载状态\n   */\n  setLoadingChildren = (key, bl, callback) => {\n    let { loadingKeys } = this.state;\n\n    let i = loadingKeys.indexOf(key);\n\n    let nextKeys = [...loadingKeys];\n\n    if (bl === true) {\n      if (i === -1) {\n        nextKeys.push(key);\n      }\n    } else {\n      if (i > -1) {\n        nextKeys.splice(i, 1);\n      }\n    }\n\n    return this.setState({ loadingKeys: nextKeys }, callback);\n  };\n\n  /**\n   * 异步加载子级数据\n   */\n  loadChildrenData = key => {\n    let { dataList, rowKey } = this.state;\n\n    let row = dataList.find(d => d[rowKey] === key);\n\n    let res = this.props.loadChildrenData(row);\n\n    if (res && res.constructor.name === \"Promise\") {\n      this.setLoadingChildren(key, true);\n\n      res.then(childrens => {\n        if (childrens) {\n          row.children = childrens;\n        }\n\n        this.setLoadingChildren(key, false);\n      });\n\n      res.catch(e => {\n        this.setLoadingChildren(key, false);\n      });\n    }\n  };\n\n  render() {\n    let {\n      columns,\n      columnLeafs,\n      dataList,\n      rowKey,\n      expandedKeys,\n      loadingKeys,\n      loading\n    } = this.state;\n\n    return (\n      <div className=\"tablex\">\n        <div className=\"tablex-head\" ref=\"head\">\n          <TableHead columns={columns} columnLeafs={columnLeafs} />\n        </div>\n\n        <div className=\"tablex-body\">\n          <TableBody\n            rowKey={rowKey}\n            columns={columns}\n            columnLeafs={columnLeafs}\n            dataSource={dataList}\n            onScroll={this.onBodyScroll}\n            onExpandChange={this.onExpandChange}\n            expandedKeys={expandedKeys}\n            loadingKeys={loadingKeys}\n          />\n          {loading === false ? <LoadingMsg /> : null}\n        </div>\n      </div>\n    );\n  }\n}\n\nTable.defaultProps = {\n  columns: [],\n  dataSource: [],\n  loading: false\n};\n\nTable.propTypes = {\n  /**\n   * 表格列\n   *\n   */\n  columns: PropTypes.array.isRequired,\n\n  /**\n   * 表格数据\n   */\n  dataSource: PropTypes.array.isRequired,\n  /** 数据行主键字段\n   * 主要用于行展开\n   */\n  rowKey: PropTypes.string.isRequired,\n  /** 行展开变化事件\n   * @expandedRows 展开的行\n   */\n  onExpandedRowsChange: PropTypes.func,\n  rowIndent: PropTypes.number,\n  expandedKeys: PropTypes.array,\n  loadChildrenData: PropTypes.func,\n  loading: PropTypes.bool\n};\n\nexport default Table;\n"]}]}