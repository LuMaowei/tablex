{"remainingRequest":"/home/nexx/develop/tablex/node_modules/thread-loader/dist/cjs.js??ref--5-1!/home/nexx/develop/tablex/node_modules/babel-loader/lib/index.js??ref--5-2!/home/nexx/develop/tablex/node_modules/source-map-loader/index.js!/home/nexx/develop/tablex/src/base/body.js","dependencies":[{"path":"/home/nexx/develop/tablex/src/base/body.js","mtime":1556973096958},{"path":"/home/nexx/develop/tablex/node_modules/cache-loader/dist/cjs.js","mtime":1555838893487},{"path":"/home/nexx/develop/tablex/node_modules/thread-loader/dist/cjs.js","mtime":1555838894922},{"path":"/home/nexx/develop/tablex/node_modules/babel-loader/lib/index.js","mtime":1555838893306},{"path":"/home/nexx/develop/tablex/node_modules/source-map-loader/index.js","mtime":1555838894829}],"contextDependencies":[],"result":["import _objectSpread from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/nexx/develop/tablex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/nexx/develop/tablex/src/base/body.js\";\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { VariableSizeGrid as Grid } from \"react-window\";\nimport AutoSizer from \"react-virtualized-auto-sizer\";\nimport LoadingIcon from \"../components/loadingIcon\";\n\nvar TableBody =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(TableBody, _React$Component);\n\n  function TableBody() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, TableBody);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TableBody)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.gridRef = React.createRef();\n\n    _this.getColumn = function (index) {\n      var columnLeafs = _this.props.columnLeafs;\n      return columnLeafs[index];\n    };\n\n    _this.getColumnWidth = function () {\n      var columnLeafs = _this.props.columnLeafs;\n      var cw = 0;\n      columnLeafs.forEach(function (d) {\n        cw += d.width || 100;\n      });\n      return cw;\n    };\n\n    _this.columnWidth = function (index, width) {\n      var column = _this.getColumn(index);\n\n      var cw = _this.getColumnWidth();\n\n      var sw = _this.props.scrollbarWidth;\n\n      if (column) {\n        return column.width || 100;\n      }\n\n      return width - cw - sw;\n    };\n\n    _this.isLoadingChildren = function (key) {\n      var loadingKeys = _this.props.loadingKeys;\n      return loadingKeys.indexOf(key) > -1;\n    };\n\n    _this.expandableEl = function (columnIndex, rowIndex, row) {\n      var _this$props = _this.props,\n          rowIndent = _this$props.rowIndent,\n          _this$props$expandedK = _this$props.expandedKeys,\n          expandedKeys = _this$props$expandedK === void 0 ? [] : _this$props$expandedK,\n          rowKey = _this$props.rowKey;\n      var indent = (row.__depth || 0) * rowIndent;\n      var key = row[rowKey];\n\n      var isLoading = _this.isLoadingChildren(key);\n\n      var isExpand = false;\n      var icon = \"+\";\n\n      if (expandedKeys.indexOf(key) > -1) {\n        isExpand = true;\n        icon = \"-\";\n      } else {\n        isExpand = false;\n        icon = \"+\";\n      }\n\n      var iconFlag = React.createElement(\"span\", {\n        className: \"tablex-row-expand-placeholder\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      });\n\n      if (row.children) {\n        iconFlag = React.createElement(\"span\", {\n          className: \"tablex-row-expand-icon\",\n          onClick: function onClick() {\n            _this.props.onExpandChange(isExpand, key);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 76\n          },\n          __self: this\n        }, icon);\n      }\n\n      if (isLoading === true) {\n        iconFlag = React.createElement(LoadingIcon, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 88\n          },\n          __self: this\n        });\n      }\n\n      if (columnIndex === 0) {\n        return React.createElement(React.Fragment, null, indent > 0 ? React.createElement(\"span\", {\n          className: \"tablex-row-indent\",\n          style: {\n            marginLeft: indent\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95\n          },\n          __self: this\n        }) : null, iconFlag);\n      }\n\n      return null;\n    };\n\n    _this.renderCell = function (_ref) {\n      var columnIndex = _ref.columnIndex,\n          rowIndex = _ref.rowIndex,\n          style = _ref.style;\n      var dataSource = _this.props.dataSource;\n\n      if (dataSource.length === 0) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111\n          },\n          __self: this\n        });\n      }\n\n      var column = _this.getColumn(columnIndex);\n\n      var attr = {};\n\n      if (columnIndex === 0) {\n        attr = {\n          position: \"sticky\",\n          zIndex: 1,\n          left: 0\n        };\n      }\n\n      if (column) {\n        var c = column.dataIndex;\n        var row = dataSource[rowIndex];\n\n        var expandableEl = _this.expandableEl(columnIndex, rowIndex, row);\n\n        var cellData = row[c];\n\n        if (typeof column.render === \"function\") {\n          return React.createElement(\"div\", {\n            className: \"tablex-cell\",\n            style: style,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 136\n            },\n            __self: this\n          }, expandableEl, \" \", column.render(cellData, row, rowIndex));\n        } else {\n          return React.createElement(\"div\", {\n            className: \"tablex-cell\",\n            style: _objectSpread({}, style, attr),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 145\n            },\n            __self: this\n          }, expandableEl, cellData);\n        }\n      }\n\n      return React.createElement(\"div\", {\n        className: \"tablex-cell\",\n        style: _objectSpread({}, style, {\n          borderRight: \"none\"\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      });\n    };\n\n    _this.scrollTo = function (pos) {\n      _this.gridRef.current && _this.gridRef.current.scrollTo(pos);\n    };\n\n    return _this;\n  }\n\n  _createClass(TableBody, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          columns = _this$props2.columns,\n          columnLeafs = _this$props2.columnLeafs,\n          dataSource = _this$props2.dataSource,\n          onScroll = _this$props2.onScroll,\n          style = _this$props2.style;\n      var columnWidth = 0;\n      columnLeafs.forEach(function (d) {\n        columnWidth += d.width || 100;\n      });\n      var rowCount = dataSource.length;\n      return React.createElement(AutoSizer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, function (_ref2) {\n        var height = _ref2.height,\n            width = _ref2.width;\n        var len = columnLeafs.length;\n\n        if (width > columnWidth) {\n          len = len + 1;\n        }\n\n        if (dataSource.length === 0) {\n          rowCount = 1;\n        }\n\n        return React.createElement(React.Fragment, null, React.createElement(Grid, {\n          style: style,\n          columnCount: len,\n          columnWidth: function columnWidth(i) {\n            return _this2.columnWidth(i, width);\n          },\n          height: height,\n          rowCount: rowCount,\n          rowHeight: function rowHeight() {\n            return 35;\n          },\n          width: width,\n          onScroll: onScroll,\n          ref: _this2.gridRef,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188\n          },\n          __self: this\n        }, _this2.renderCell));\n      });\n    }\n  }, {\n    key: \"__reactstandin__regenerateByEval\",\n    // @ts-ignore\n    value: function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }]);\n\n  return TableBody;\n}(React.Component);\n\nTableBody.defaultProps = {\n  columns: [],\n  columnLeafs: [],\n  dataSource: [],\n  rowIndent: 20,\n  expandedKeys: [],\n  loadingKeys: [],\n  scrollbarWidth: 6\n};\nTableBody.propTypes = {\n  /**\n   * 主要用于行展开\n   */\n  rowKey: PropTypes.string.isRequired,\n  columns: PropTypes.array.isRequired,\n  columnLeafs: PropTypes.array.isRequired,\n  dataSource: PropTypes.array.isRequired,\n  onScroll: PropTypes.func,\n\n  /**\n   * @isExpand 是否展开\n   * @key 受影响的行数据key\n   */\n  onExpandChange: PropTypes.func,\n  rowIndent: PropTypes.number,\n  expandedKeys: PropTypes.array,\n  loadingKeys: PropTypes.array,\n  scrollbarWidth: PropTypes.number\n};\nvar _default = TableBody;\nexport default _default;\n\nif (typeof TableBody !== 'undefined' && TableBody && TableBody === Object(TableBody) && Object.isExtensible(TableBody)) {\n  Object.defineProperty(TableBody, '__filemeta', {\n    enumerable: true,\n    configurable: true,\n    value: {\n      name: \"TableBody\",\n      filename: \"src/base/body.js\"\n    }\n  });\n}\n\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(TableBody, \"TableBody\", \"/home/nexx/develop/tablex/src/base/body.js\");\n  reactHotLoader.register(_default, \"default\", \"/home/nexx/develop/tablex/src/base/body.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();",{"version":3,"sources":["/home/nexx/develop/tablex/src/base/body.js"],"names":["React","PropTypes","VariableSizeGrid","Grid","AutoSizer","LoadingIcon","TableBody","gridRef","createRef","getColumn","index","columnLeafs","props","getColumnWidth","cw","forEach","d","width","columnWidth","column","sw","scrollbarWidth","isLoadingChildren","key","loadingKeys","indexOf","expandableEl","columnIndex","rowIndex","row","rowIndent","expandedKeys","rowKey","indent","__depth","isLoading","isExpand","icon","iconFlag","children","onExpandChange","marginLeft","renderCell","style","dataSource","length","attr","position","zIndex","left","c","dataIndex","cellData","render","borderRight","scrollTo","pos","current","columns","onScroll","rowCount","height","len","i","Component","defaultProps","propTypes","string","isRequired","array","func","number"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { VariableSizeGrid as Grid } from \"react-window\";\nimport AutoSizer from \"react-virtualized-auto-sizer\";\nimport LoadingIcon from \"../components/loadingIcon\";\n\nclass TableBody extends React.Component {\n\n\n\n gridRef = React.createRef();\n\n\n  getColumn = index => {\n    let { columnLeafs } = this.props;\n\n    return columnLeafs[index];\n  };\n\n  getColumnWidth = () => {\n    let { columnLeafs } = this.props;\n\n    let cw = 0;\n    columnLeafs.forEach(d => {\n      cw += d.width || 100;\n    });\n\n    return cw;\n  };\n\n  columnWidth = (index, width) => {\n    let column = this.getColumn(index);\n    let cw = this.getColumnWidth();\n    let sw = this.props.scrollbarWidth;\n\n    if (column) {\n      return column.width || 100;\n    }\n\n    return width - cw - sw;\n  };\n\n  /**\n   * 行是否正在加载子级\n   */\n  isLoadingChildren = key => {\n    let { loadingKeys } = this.props;\n\n    return loadingKeys.indexOf(key) > -1;\n  };\n\n  expandableEl = (columnIndex, rowIndex, row) => {\n    let { rowIndent, expandedKeys = [], rowKey } = this.props;\n\n    let indent = (row.__depth || 0) * rowIndent;\n\n    let key = row[rowKey];\n\n    let isLoading = this.isLoadingChildren(key);\n\n    let isExpand = false;\n    let icon = \"+\";\n\n    if (expandedKeys.indexOf(key) > -1) {\n      isExpand = true;\n      icon = \"-\";\n    } else {\n      isExpand = false;\n      icon = \"+\";\n    }\n\n    let iconFlag = <span className=\"tablex-row-expand-placeholder\" />;\n\n    if (row.children) {\n      iconFlag = (\n        <span\n          className=\"tablex-row-expand-icon\"\n          onClick={() => {\n            this.props.onExpandChange(isExpand, key);\n          }}\n        >\n          {icon}\n        </span>\n      );\n    }\n\n    if (isLoading === true) {\n      iconFlag = <LoadingIcon />;\n    }\n\n    if (columnIndex === 0) {\n      return (\n        <>\n          {indent > 0 ? (\n            <span\n              className=\"tablex-row-indent\"\n              style={{ marginLeft: indent }}\n            />\n          ) : null}\n          {iconFlag}\n        </>\n      );\n    }\n    return null;\n  };\n\n  renderCell = ({ columnIndex, rowIndex, style }) => {\n    let { dataSource } = this.props;\n\n    if (dataSource.length === 0) {\n      return <div />;\n    }\n\n    let column = this.getColumn(columnIndex);\n\n    let attr={};\n\n    if (columnIndex===0) {\n      attr={\n        position:\"sticky\",\n        zIndex:1,\n        left:0\n      }\n    }\n\n    if (column) {\n      let c = column.dataIndex;\n      let row = dataSource[rowIndex];\n\n      let expandableEl = this.expandableEl(columnIndex, rowIndex, row);\n\n      let cellData = row[c];\n\n      if (typeof column.render === \"function\") {\n        return (\n          <div className=\"tablex-cell\" style={style}>\n            {expandableEl} {column.render(cellData, row, rowIndex)}\n          </div>\n        );\n      } else {\n\n\n\n        return (\n          <div className=\"tablex-cell\" style={{...style,...attr}}>\n            {expandableEl}\n            {cellData}\n          </div>\n        );\n      }\n    }\n\n    return (\n      <div className=\"tablex-cell\" style={{ ...style, borderRight: \"none\" }} />\n    );\n  };\n\n\n  scrollTo=(pos)=>{\n    this.gridRef.current&&this.gridRef.current.scrollTo(pos);\n  }\n\n  render() {\n    let { columns, columnLeafs, dataSource, onScroll,style } = this.props;\n\n    let columnWidth = 0;\n    columnLeafs.forEach(d => {\n      columnWidth += d.width || 100;\n    });\n\n    let rowCount = dataSource.length;\n\n    return (\n      <AutoSizer>\n        {({ height, width }) => {\n          let len = columnLeafs.length;\n\n          if (width > columnWidth) {\n            len = len + 1;\n          }\n\n          if (dataSource.length === 0) {\n            rowCount = 1;\n          }\n\n          return (\n            <>\n              <Grid\n                style={style}\n                columnCount={len}\n                columnWidth={i => this.columnWidth(i, width)}\n                height={height}\n                rowCount={rowCount}\n                rowHeight={() => 35}\n                width={width}\n                onScroll={onScroll}\n                ref={this.gridRef}\n              >\n                {this.renderCell}\n              </Grid>\n            </>\n          );\n        }}\n      </AutoSizer>\n    );\n  }\n}\n\nTableBody.defaultProps = {\n  columns: [],\n  columnLeafs: [],\n  dataSource: [],\n  rowIndent: 20,\n  expandedKeys: [],\n  loadingKeys: [],\n  scrollbarWidth: 6\n};\n\nTableBody.propTypes = {\n  /**\n   * 主要用于行展开\n   */\n  rowKey: PropTypes.string.isRequired,\n  columns: PropTypes.array.isRequired,\n  columnLeafs: PropTypes.array.isRequired,\n  dataSource: PropTypes.array.isRequired,\n  onScroll: PropTypes.func,\n\n  /**\n   * @isExpand 是否展开\n   * @key 受影响的行数据key\n   */\n  onExpandChange: PropTypes.func,\n  rowIndent: PropTypes.number,\n  expandedKeys: PropTypes.array,\n  loadingKeys: PropTypes.array,\n  scrollbarWidth: PropTypes.number\n};\n\nexport default TableBody;\n"]}]}